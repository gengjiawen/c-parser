(function(){"use strict";var e=(t=>(t[t.IntLiteral=0]="IntLiteral",t[t.UIntLiteral=1]="UIntLiteral",t[t.LongLiteral=2]="LongLiteral",t[t.ULongLiteral=3]="ULongLiteral",t[t.LongLongLiteral=4]="LongLongLiteral",t[t.ULongLongLiteral=5]="ULongLongLiteral",t[t.FloatLiteral=6]="FloatLiteral",t[t.FloatLiteralF32=7]="FloatLiteralF32",t[t.FloatLiteralLongDouble=8]="FloatLiteralLongDouble",t[t.ImaginaryLiteral=9]="ImaginaryLiteral",t[t.ImaginaryLiteralF32=10]="ImaginaryLiteralF32",t[t.ImaginaryLiteralLongDouble=11]="ImaginaryLiteralLongDouble",t[t.StringLiteral=12]="StringLiteral",t[t.WideStringLiteral=13]="WideStringLiteral",t[t.Char16StringLiteral=14]="Char16StringLiteral",t[t.CharLiteral=15]="CharLiteral",t[t.Identifier=16]="Identifier",t[t.Auto=17]="Auto",t[t.Break=18]="Break",t[t.Case=19]="Case",t[t.Char=20]="Char",t[t.Const=21]="Const",t[t.Continue=22]="Continue",t[t.Default=23]="Default",t[t.Do=24]="Do",t[t.Double=25]="Double",t[t.Else=26]="Else",t[t.Enum=27]="Enum",t[t.Extern=28]="Extern",t[t.Float=29]="Float",t[t.For=30]="For",t[t.Goto=31]="Goto",t[t.If=32]="If",t[t.Inline=33]="Inline",t[t.Int=34]="Int",t[t.Long=35]="Long",t[t.Register=36]="Register",t[t.Restrict=37]="Restrict",t[t.Return=38]="Return",t[t.Short=39]="Short",t[t.Signed=40]="Signed",t[t.Sizeof=41]="Sizeof",t[t.Static=42]="Static",t[t.Struct=43]="Struct",t[t.Switch=44]="Switch",t[t.Typedef=45]="Typedef",t[t.Union=46]="Union",t[t.Unsigned=47]="Unsigned",t[t.Void=48]="Void",t[t.Volatile=49]="Volatile",t[t.While=50]="While",t[t.Alignas=51]="Alignas",t[t.Alignof=52]="Alignof",t[t.Atomic=53]="Atomic",t[t.Bool=54]="Bool",t[t.Complex=55]="Complex",t[t.Generic=56]="Generic",t[t.Imaginary=57]="Imaginary",t[t.Noreturn=58]="Noreturn",t[t.StaticAssert=59]="StaticAssert",t[t.ThreadLocal=60]="ThreadLocal",t[t.Typeof=61]="Typeof",t[t.Asm=62]="Asm",t[t.Attribute=63]="Attribute",t[t.Extension=64]="Extension",t[t.Builtin=65]="Builtin",t[t.BuiltinVaArg=66]="BuiltinVaArg",t[t.BuiltinTypesCompatibleP=67]="BuiltinTypesCompatibleP",t[t.Int128=68]="Int128",t[t.UInt128=69]="UInt128",t[t.RealPart=70]="RealPart",t[t.ImagPart=71]="ImagPart",t[t.AutoType=72]="AutoType",t[t.GnuAlignof=73]="GnuAlignof",t[t.GnuLabel=74]="GnuLabel",t[t.SegGs=75]="SegGs",t[t.SegFs=76]="SegFs",t[t.PragmaPackSet=77]="PragmaPackSet",t[t.PragmaPackPush=78]="PragmaPackPush",t[t.PragmaPackPushOnly=79]="PragmaPackPushOnly",t[t.PragmaPackPop=80]="PragmaPackPop",t[t.PragmaPackReset=81]="PragmaPackReset",t[t.PragmaVisibilityPush=82]="PragmaVisibilityPush",t[t.PragmaVisibilityPop=83]="PragmaVisibilityPop",t[t.LParen=84]="LParen",t[t.RParen=85]="RParen",t[t.LBrace=86]="LBrace",t[t.RBrace=87]="RBrace",t[t.LBracket=88]="LBracket",t[t.RBracket=89]="RBracket",t[t.Semicolon=90]="Semicolon",t[t.Comma=91]="Comma",t[t.Dot=92]="Dot",t[t.Arrow=93]="Arrow",t[t.Ellipsis=94]="Ellipsis",t[t.Plus=95]="Plus",t[t.Minus=96]="Minus",t[t.Star=97]="Star",t[t.Slash=98]="Slash",t[t.Percent=99]="Percent",t[t.Amp=100]="Amp",t[t.Pipe=101]="Pipe",t[t.Caret=102]="Caret",t[t.Tilde=103]="Tilde",t[t.Bang=104]="Bang",t[t.Assign=105]="Assign",t[t.Less=106]="Less",t[t.Greater=107]="Greater",t[t.Question=108]="Question",t[t.Colon=109]="Colon",t[t.PlusPlus=110]="PlusPlus",t[t.MinusMinus=111]="MinusMinus",t[t.PlusAssign=112]="PlusAssign",t[t.MinusAssign=113]="MinusAssign",t[t.StarAssign=114]="StarAssign",t[t.SlashAssign=115]="SlashAssign",t[t.PercentAssign=116]="PercentAssign",t[t.AmpAssign=117]="AmpAssign",t[t.PipeAssign=118]="PipeAssign",t[t.CaretAssign=119]="CaretAssign",t[t.LessLess=120]="LessLess",t[t.GreaterGreater=121]="GreaterGreater",t[t.LessLessAssign=122]="LessLessAssign",t[t.GreaterGreaterAssign=123]="GreaterGreaterAssign",t[t.EqualEqual=124]="EqualEqual",t[t.BangEqual=125]="BangEqual",t[t.LessEqual=126]="LessEqual",t[t.GreaterEqual=127]="GreaterEqual",t[t.AmpAmp=128]="AmpAmp",t[t.PipePipe=129]="PipePipe",t[t.Hash=130]="Hash",t[t.HashHash=131]="HashHash",t[t.Eof=132]="Eof",t))(e||{});function fe(){return{start:0,end:0}}function de(t,s){const i=t.length;if(i<2||i>17&&i!==28)return;const n=t.charCodeAt(0);if(!(n!==95&&n!==97&&n!==98&&n!==99&&n!==100&&n!==101&&n!==102&&n!==103&&n!==105&&n!==108&&n!==114&&n!==115&&n!==116&&n!==117&&n!==118&&n!==119))switch(t){case"auto":return 17;case"break":return 18;case"case":return 19;case"char":return 20;case"const":return 21;case"continue":return 22;case"default":return 23;case"do":return 24;case"double":return 25;case"else":return 26;case"enum":return 27;case"extern":return 28;case"float":return 29;case"for":return 30;case"goto":return 31;case"if":return 32;case"inline":return 33;case"int":return 34;case"long":return 35;case"register":return 36;case"restrict":return 37;case"return":return 38;case"short":return 39;case"signed":return 40;case"sizeof":return 41;case"static":return 42;case"struct":return 43;case"switch":return 44;case"typedef":return 45;case"union":return 46;case"unsigned":return 47;case"void":return 48;case"volatile":case"__volatile__":case"__volatile":return 49;case"__const":case"__const__":return 21;case"__inline":case"__inline__":return 33;case"__restrict":case"__restrict__":return 37;case"__signed__":return 40;case"while":return 50;case"_Alignas":return 51;case"_Alignof":return 52;case"_Atomic":return 53;case"_Bool":return 54;case"_Complex":case"__complex__":case"__complex":return 55;case"_Generic":return 56;case"_Imaginary":return 57;case"_Noreturn":case"__noreturn__":return 58;case"_Static_assert":case"static_assert":return 59;case"_Thread_local":case"__thread":return 60;case"typeof":return s?61:void 0;case"__typeof__":case"__typeof":return 61;case"asm":return s?62:void 0;case"__asm__":case"__asm":return 62;case"__attribute__":case"__attribute":return 63;case"__extension__":return 64;case"__builtin_va_list":return 65;case"__builtin_va_arg":return 66;case"__builtin_types_compatible_p":return 67;case"__int128":case"__int128_t":return 68;case"__uint128_t":return 69;case"__real__":case"__real":return 70;case"__imag__":case"__imag":return 71;case"__auto_type":return 72;case"__alignof":case"__alignof__":return 73;case"__label__":return 74;case"__seg_gs":return 75;case"__seg_fs":return 76;default:return}}const b=48,Vt=55,St=57,At=65,ge=66,wt=69,at=70,rt=73,$t=74,O=76,Bt=80,xt=85,me=88,vt=97,jt=98,Ut=101,Z=102,ct=105,Yt=106,ot=108,ye=110,Nt=112,ke=114,Se=116,ht=117,Ae=118,Jt=120,K=34,U=39,tt=92,Pt=95,Zt=36,T=46,Lt=35,pt=47,Gt=42,Ct=10,Kt=32,_t=43,Et=45,xe=40,ve=41,Pe=123,Le=125,Ce=91,_e=93,Ee=59,be=44,Fe=126,Ie=63,Te=58,De=37,te=38,ee=124,Re=94,Ve=33,L=61,se=60,zt=62,we=Number.MAX_SAFE_INTEGER;function N(t){return t>=b&&t<=St}function lt(t){return t>=b&&t<=St||t>=vt&&t<=Z||t>=At&&t<=at}function ie(t){return t>=vt&&t<=122||t>=At&&t<=90}function Ht(t){return ie(t)||N(t)}function Be(t){return t===Pt||t===Zt||ie(t)}function Ue(t){return t===Pt||t===Zt||Ht(t)}function Ne(t){return t===Kt||t===9||t===Ct||t===13||t===12||t===11}function ne(t){return t>=b&&t<=St?t-b:t>=vt&&t<=Z?t-vt+10:t>=At&&t<=at?t-At+10:0}class bt{constructor(s,i=!0){this.src=s,this.len=s.length,this.pos=0,this.gnuExtensions=i}scan(){const s=[];for(;;){const i=this.nextToken();if(s.push(i),i.kind===e.Eof)break}return s}ch(){return this.src.charCodeAt(this.pos)}chAt(s){return this.src.charCodeAt(s)}nextToken(){if(this.skipWhitespaceAndComments(),this.pos>=this.len)return{kind:e.Eof,start:this.pos,end:this.pos};const s=this.pos,i=this.ch();return N(i)||i===T&&this.pos+1<this.len&&N(this.chAt(this.pos+1))?this.lexNumber(s):i===K?this.lexString(s):i===U?this.lexChar(s):Be(i)?this.lexIdentifier(s):this.lexPunctuation(s)}skipWhitespaceAndComments(){for(;;){for(;this.pos<this.len&&Ne(this.ch());)this.pos++;if(this.pos>=this.len)return;if(this.ch()===Lt&&this.isLineMarker()){for(;this.pos<this.len&&this.ch()!==Ct;)this.pos++;continue}if(this.pos+1<this.len&&this.ch()===pt&&this.chAt(this.pos+1)===pt){for(;this.pos<this.len&&this.ch()!==Ct;)this.pos++;continue}if(this.pos+1<this.len&&this.ch()===pt&&this.chAt(this.pos+1)===Gt){for(this.pos+=2;this.pos+1<this.len;){if(this.ch()===Gt&&this.chAt(this.pos+1)===pt){this.pos+=2;break}this.pos++}continue}break}}isLineMarker(){if(this.pos>=this.len||this.ch()!==Lt||this.pos>0&&this.chAt(this.pos-1)!==Ct)return!1;let s=this.pos+1;for(;s<this.len&&this.chAt(s)===Kt;)s++;return s<this.len&&N(this.chAt(s))}lexNumber(s){if(this.pos+1<this.len&&this.ch()===b&&(this.chAt(this.pos+1)===Jt||this.chAt(this.pos+1)===me))return this.lexHexNumber(s);if(this.pos+1<this.len&&this.ch()===b&&(this.chAt(this.pos+1)===jt||this.chAt(this.pos+1)===ge))return this.lexBinaryNumber(s);const i=this.lexOctalNumber(s);return i!==null?i:this.lexDecimalNumber(s)}lexHexNumber(s){this.pos+=2;const i=this.pos;for(;this.pos<this.len&&lt(this.ch());)this.pos++;const n=this.pos<this.len&&this.ch()===T;let a=!1;if(n){let h=this.pos+1;for(;h<this.len&&lt(this.chAt(h));)h++;a=h<this.len&&(this.chAt(h)===Nt||this.chAt(h)===Bt)}const r=this.pos<this.len&&(this.ch()===Nt||this.ch()===Bt);if(n&&a||r)return this.lexHexFloat(s,i,n);const c=this.src.substring(i,this.pos),o=c.length>0?Ge(c):0n;return this.finishIntLiteral(o,!0,s)}lexHexFloat(s,i,n){const a=this.src.substring(i,this.pos);let r="";if(n){this.pos++;const g=this.pos;for(;this.pos<this.len&&lt(this.ch());)this.pos++;r=this.src.substring(g,this.pos)}let c=0;if(this.pos<this.len&&(this.ch()===Nt||this.ch()===Bt)){this.pos++;let g=!1;this.pos<this.len&&this.ch()===Et?(this.pos++,g=!0):this.pos<this.len&&this.ch()===_t&&this.pos++;const S=this.pos;for(;this.pos<this.len&&N(this.ch());)this.pos++;const m=this.src.substring(S,this.pos),d=parseInt(m,10)||0;c=g?-d:d}const o=a.length>0?parseInt(a,16):0;let h=0;r.length>0&&(h=parseInt(r,16)/Math.pow(16,r.length));const p=(o+h)*Math.pow(2,c),l=this.parseSimpleFloatSuffix();return l===1?{kind:e.FloatLiteralF32,start:s,end:this.pos,value:p}:l===2?{kind:e.FloatLiteralLongDouble,start:s,end:this.pos,value:p}:{kind:e.FloatLiteral,start:s,end:this.pos,value:p}}parseSimpleFloatSuffix(){return this.pos<this.len&&(this.ch()===Z||this.ch()===at)?(this.pos++,1):this.pos<this.len&&(this.ch()===ot||this.ch()===O)?(this.pos++,2):0}lexBinaryNumber(s){this.pos+=2;const i=this.pos;for(;this.pos<this.len&&(this.ch()===b||this.ch()===49);)this.pos++;const n=this.src.substring(i,this.pos),a=n.length>0?ze(n):0n;return this.finishIntLiteral(a,!0,s)}lexOctalNumber(s){if(this.ch()!==b||this.pos+1>=this.len||!N(this.chAt(this.pos+1)))return null;const i=this.pos;this.pos++;const n=this.pos;for(;this.pos<this.len&&this.ch()>=b&&this.ch()<=Vt;)this.pos++;if(this.pos<this.len){const c=this.ch();if((c===T||c===Ut||c===wt||c===56||c===St)&&!(c===T&&this.pos+2<this.len&&this.chAt(this.pos+1)===T&&this.chAt(this.pos+2)===T))return this.pos=i,null}const a=this.src.substring(n,this.pos),r=a.length>0?He(a):0n;return this.finishIntLiteral(r,!0,s)}lexDecimalNumber(s){let i=!1;for(;this.pos<this.len&&N(this.ch());)this.pos++;if(this.pos<this.len&&this.ch()===T&&!(this.pos+2<this.len&&this.chAt(this.pos+1)===T&&this.chAt(this.pos+2)===T))for(i=!0,this.pos++;this.pos<this.len&&N(this.ch());)this.pos++;if(this.pos<this.len&&(this.ch()===Ut||this.ch()===wt))for(i=!0,this.pos++,this.pos<this.len&&(this.ch()===_t||this.ch()===Et)&&this.pos++;this.pos<this.len&&N(this.ch());)this.pos++;const n=this.pos;if(i){const{floatKind:c,isImaginary:o}=this.parseFloatSuffix(),h=this.src.substring(s,n);return this.makeFloatToken(h,c,o,s)}const a=this.src.substring(s,n),r=Me(a);return this.finishIntLiteral(r,!1,s)}parseFloatSuffix(){let s=!1,i;return this.pos<this.len&&(this.ch()===Z||this.ch()===at)?(this.pos++,this.pos<this.len&&(this.ch()===ct||this.ch()===rt)&&(this.pos++,s=!0),i=1):this.pos<this.len&&(this.ch()===ot||this.ch()===O)?(this.pos++,this.pos<this.len&&(this.ch()===ct||this.ch()===rt)&&(this.pos++,s=!0),i=2):this.pos<this.len&&(this.ch()===ct||this.ch()===rt)?(this.pos++,s=!0,this.pos<this.len&&(this.ch()===Z||this.ch()===at)?(this.pos++,i=1):this.pos<this.len&&(this.ch()===ot||this.ch()===O)?(this.pos++,i=2):i=0):i=0,!s&&this.pos<this.len&&(this.ch()===Yt||this.ch()===$t)&&(this.pos++,s=!0),{floatKind:i,isImaginary:s}}makeFloatToken(s,i,n,a){const r=parseFloat(s)||0;return n?i===1?{kind:e.ImaginaryLiteralF32,start:a,end:this.pos,value:r}:i===2?{kind:e.ImaginaryLiteralLongDouble,start:a,end:this.pos,value:r}:{kind:e.ImaginaryLiteral,start:a,end:this.pos,value:r}:i===1?{kind:e.FloatLiteralF32,start:a,end:this.pos,value:r}:i===2?{kind:e.FloatLiteralLongDouble,start:a,end:this.pos,value:r}:{kind:e.FloatLiteral,start:a,end:this.pos,value:r}}parseIntSuffix(){let s=!1;if(this.pos<this.len&&(this.ch()===ct||this.ch()===rt)){const r=this.pos+1<this.len?this.chAt(this.pos+1):0;if(!Ht(r)&&r!==Pt)return this.pos++,{isUnsigned:!1,isLong:!1,isLongLong:!1,isImaginary:!0}}let i=!1,n=!1,a=!1;for(;;)if(this.pos<this.len&&(this.ch()===ht||this.ch()===xt))i=!0,this.pos++;else if(this.pos<this.len&&(this.ch()===ot||this.ch()===O))this.pos++,this.pos<this.len&&(this.ch()===ot||this.ch()===O)?(a=!0,this.pos++):n=!0;else break;if(this.pos<this.len&&(this.ch()===ct||this.ch()===rt||this.ch()===Yt||this.ch()===$t)){const r=this.pos+1<this.len?this.chAt(this.pos+1):0;!Ht(r)&&r!==Pt&&(this.pos++,s=!0)}return{isUnsigned:i,isLong:n,isLongLong:a,isImaginary:s}}finishIntLiteral(s,i,n){const{isUnsigned:a,isLong:r,isLongLong:c,isImaginary:o}=this.parseIntSuffix();return o?this.makeToken(e.ImaginaryLiteral,n,Number(s)):this.makeIntToken(s,a,r,c,i,n)}makeIntToken(s,i,n,a,r,c){const o=0x7fffffffn,h=0xffffffffn,p=0x7fffffffffffffffn;return i&&a?this.makeIntOrBigToken(e.ULongLongLiteral,c,s):i&&n?this.makeIntOrBigToken(e.ULongLiteral,c,s):i?s>h?this.makeIntOrBigToken(e.ULongLiteral,c,s):this.makeIntOrBigToken(e.UIntLiteral,c,s):a?r&&s>p?this.makeIntOrBigToken(e.ULongLongLiteral,c,s):this.makeIntOrBigToken(e.LongLongLiteral,c,s):n?r&&s>p?this.makeIntOrBigToken(e.ULongLiteral,c,s):this.makeIntOrBigToken(e.LongLiteral,c,s):r?s<=o?this.makeIntOrBigToken(e.IntLiteral,c,s):s<=h?this.makeIntOrBigToken(e.UIntLiteral,c,s):s<=p?this.makeIntOrBigToken(e.LongLiteral,c,s):this.makeIntOrBigToken(e.ULongLiteral,c,s):s>p?this.makeIntOrBigToken(e.ULongLiteral,c,s):s<=o?this.makeIntOrBigToken(e.IntLiteral,c,s):this.makeIntOrBigToken(e.LongLiteral,c,s)}makeIntOrBigToken(s,i,n){return n<=BigInt(we)?{kind:s,start:i,end:this.pos,value:Number(n)}:{kind:s,start:i,end:this.pos,bigValue:n}}makeToken(s,i,n){return n!==void 0?{kind:s,start:i,end:this.pos,value:n}:{kind:s,start:i,end:this.pos}}lexString(s){this.pos++;let i="";for(;this.pos<this.len&&this.ch()!==K;)if(this.ch()===tt){if(this.pos++,this.pos<this.len){const n=this.lexEscapeChar();if(n.codePointAt(0)>255)for(let a=0;a<n.length;a++){const r=n.codePointAt(a);r<128?i+=String.fromCharCode(r):r<2048?(i+=String.fromCharCode(192|r>>6),i+=String.fromCharCode(128|r&63)):r<65536?(i+=String.fromCharCode(224|r>>12),i+=String.fromCharCode(128|r>>6&63),i+=String.fromCharCode(128|r&63)):(i+=String.fromCharCode(240|r>>18),i+=String.fromCharCode(128|r>>12&63),i+=String.fromCharCode(128|r>>6&63),i+=String.fromCharCode(128|r&63)),r>65535&&a++}else i+=n}}else i+=this.src[this.pos],this.pos++;return this.pos<this.len&&this.pos++,{kind:e.StringLiteral,start:s,end:this.pos,value:i}}lexWideString(s){this.pos++;let i="";for(;this.pos<this.len&&this.ch()!==K;)this.ch()===tt?(this.pos++,this.pos<this.len&&(i+=this.lexEscapeChar())):(i+=this.src[this.pos],this.pos++);return this.pos<this.len&&this.pos++,{kind:e.WideStringLiteral,start:s,end:this.pos,value:i}}lexChar16String(s){this.pos++;let i="";for(;this.pos<this.len&&this.ch()!==K;)this.ch()===tt?(this.pos++,this.pos<this.len&&(i+=this.lexEscapeChar())):(i+=this.src[this.pos],this.pos++);return this.pos<this.len&&this.pos++,{kind:e.Char16StringLiteral,start:s,end:this.pos,value:i}}lexChar(s){this.pos++;let i=0,n=0;for(;this.pos<this.len&&this.ch()!==U;){let a;this.ch()===tt?(this.pos++,a=this.lexEscapeChar()):(a=this.src[this.pos],this.pos++);const r=a.codePointAt(0);if(r>255){const c=[];r<2048?c.push(192|r>>6,128|r&63):r<65536?c.push(224|r>>12,128|r>>6&63,128|r&63):c.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63);for(const o of c)i=i<<8|o,n++}else i=i<<8|r&255,n++}if(this.pos<this.len&&this.ch()===U&&this.pos++,n<=1){const a=i===0?"\0":String.fromCharCode(i&255);return{kind:e.CharLiteral,start:s,end:this.pos,value:a}}return{kind:e.IntLiteral,start:s,end:this.pos,value:i}}lexWideChar(s){this.pos++;let i=0;for(this.pos<this.len&&this.ch()!==U&&(this.ch()===tt?(this.pos++,i=this.lexEscapeChar().codePointAt(0)):(i=this.src.codePointAt(this.pos),this.pos+=i>65535?2:1));this.pos<this.len&&this.ch()!==U;)this.pos++;return this.pos<this.len&&this.ch()===U&&this.pos++,{kind:e.IntLiteral,start:s,end:this.pos,value:i}}lexEscapeChar(){if(this.pos>=this.len)return"\0";const s=this.ch();switch(this.pos++,s){case ye:return`
`;case Se:return"	";case ke:return"\r";case tt:return"\\";case U:return"'";case K:return'"';case 97:return"\x07";case jt:return"\b";case Ut:case wt:return"\x1B";case Z:return"\f";case Ae:return"\v";case Jt:{let i=0;for(;this.pos<this.len&&lt(this.ch());)i=i*16+ne(this.ch()),this.pos++;return String.fromCharCode(i&255)}case ht:return this.lexUnicodeEscape(4);case xt:return this.lexUnicodeEscape(8);default:{if(s>=b&&s<=Vt){let i=s-b;for(let n=0;n<2&&(this.pos<this.len&&this.ch()>=b&&this.ch()<=Vt);n++)i=i*8+(this.ch()-b),this.pos++;return String.fromCharCode(i&255)}return String.fromCharCode(s)}}}lexUnicodeEscape(s){let i=0;for(let n=0;n<s&&(this.pos<this.len&&lt(this.ch()));n++)i=i*16+ne(this.ch()),this.pos++;try{return String.fromCodePoint(i)}catch{return"ï¿½"}}lexIdentifier(s){for(;this.pos<this.len&&Ue(this.ch());)this.pos++;if(this.pos<this.len){const c=this.pos-s,o=this.ch();if(o===U||o===K){let h=!1;if(c===1){const p=this.chAt(s);h=p===O||p===ht||p===xt}else c===2&&(h=this.chAt(s)===ht&&this.chAt(s+1)===56);if(h){if(o===U)return this.lexWideChar(s);const p=this.chAt(s);return c===1&&(p===O||p===xt)?this.lexWideString(s):c===1&&p===ht?this.lexChar16String(s):this.lexString(s)}}}const i=this.src.substring(s,this.pos),n=bt.tryPragmaPackToken(i);if(n!==null)return{kind:n.kind,start:s,end:this.pos,value:n.value};const a=bt.tryPragmaVisibilityToken(i);if(a!==null)return{kind:a.kind,start:s,end:this.pos,value:a.value};const r=de(i,this.gnuExtensions);return r!==void 0?{kind:r,start:s,end:this.pos}:{kind:e.Identifier,start:s,end:this.pos,value:i}}static tryPragmaPackToken(s){if(!s.startsWith("__ccc_pack_"))return null;const i=s.substring(11);if(i==="pop")return{kind:e.PragmaPackPop};if(i==="reset")return{kind:e.PragmaPackReset};if(i==="push_only")return{kind:e.PragmaPackPushOnly};if(i.startsWith("set_")){const n=parseInt(i.substring(4),10);if(!isNaN(n))return{kind:e.PragmaPackSet,value:n}}if(i.startsWith("push_")){const n=parseInt(i.substring(5),10);if(!isNaN(n))return{kind:e.PragmaPackPush,value:n}}return null}static tryPragmaVisibilityToken(s){if(!s.startsWith("__ccc_visibility_"))return null;const i=s.substring(17);if(i==="pop")return{kind:e.PragmaVisibilityPop};if(i.startsWith("push_")){const n=i.substring(5);if(n==="hidden"||n==="default"||n==="protected"||n==="internal")return{kind:e.PragmaVisibilityPush,value:n}}return null}lexPunctuation(s){const i=this.ch();switch(this.pos++,i){case xe:return{kind:e.LParen,start:s,end:this.pos};case ve:return{kind:e.RParen,start:s,end:this.pos};case Pe:return{kind:e.LBrace,start:s,end:this.pos};case Le:return{kind:e.RBrace,start:s,end:this.pos};case Ce:return{kind:e.LBracket,start:s,end:this.pos};case _e:return{kind:e.RBracket,start:s,end:this.pos};case Ee:return{kind:e.Semicolon,start:s,end:this.pos};case be:return{kind:e.Comma,start:s,end:this.pos};case Fe:return{kind:e.Tilde,start:s,end:this.pos};case Ie:return{kind:e.Question,start:s,end:this.pos};case Te:return{kind:e.Colon,start:s,end:this.pos};case Lt:return this.pos<this.len&&this.ch()===Lt?(this.pos++,{kind:e.HashHash,start:s,end:this.pos}):{kind:e.Hash,start:s,end:this.pos};case T:return this.pos+1<this.len&&this.ch()===T&&this.chAt(this.pos+1)===T?(this.pos+=2,{kind:e.Ellipsis,start:s,end:this.pos}):{kind:e.Dot,start:s,end:this.pos};case _t:if(this.pos<this.len){if(this.ch()===_t)return this.pos++,{kind:e.PlusPlus,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.PlusAssign,start:s,end:this.pos}}return{kind:e.Plus,start:s,end:this.pos};case Et:if(this.pos<this.len){if(this.ch()===Et)return this.pos++,{kind:e.MinusMinus,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.MinusAssign,start:s,end:this.pos};if(this.ch()===zt)return this.pos++,{kind:e.Arrow,start:s,end:this.pos}}return{kind:e.Minus,start:s,end:this.pos};case Gt:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.StarAssign,start:s,end:this.pos}):{kind:e.Star,start:s,end:this.pos};case pt:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.SlashAssign,start:s,end:this.pos}):{kind:e.Slash,start:s,end:this.pos};case De:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.PercentAssign,start:s,end:this.pos}):{kind:e.Percent,start:s,end:this.pos};case te:if(this.pos<this.len){if(this.ch()===te)return this.pos++,{kind:e.AmpAmp,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.AmpAssign,start:s,end:this.pos}}return{kind:e.Amp,start:s,end:this.pos};case ee:if(this.pos<this.len){if(this.ch()===ee)return this.pos++,{kind:e.PipePipe,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.PipeAssign,start:s,end:this.pos}}return{kind:e.Pipe,start:s,end:this.pos};case Re:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.CaretAssign,start:s,end:this.pos}):{kind:e.Caret,start:s,end:this.pos};case Ve:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.BangEqual,start:s,end:this.pos}):{kind:e.Bang,start:s,end:this.pos};case L:return this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.EqualEqual,start:s,end:this.pos}):{kind:e.Assign,start:s,end:this.pos};case se:if(this.pos<this.len){if(this.ch()===se)return this.pos++,this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.LessLessAssign,start:s,end:this.pos}):{kind:e.LessLess,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.LessEqual,start:s,end:this.pos}}return{kind:e.Less,start:s,end:this.pos};case zt:if(this.pos<this.len){if(this.ch()===zt)return this.pos++,this.pos<this.len&&this.ch()===L?(this.pos++,{kind:e.GreaterGreaterAssign,start:s,end:this.pos}):{kind:e.GreaterGreater,start:s,end:this.pos};if(this.ch()===L)return this.pos++,{kind:e.GreaterEqual,start:s,end:this.pos}}return{kind:e.Greater,start:s,end:this.pos};default:return this.nextToken()}}}function Ge(t){if(t.length===0)return 0n;try{return BigInt("0x"+t)}catch{return 0n}}function ze(t){if(t.length===0)return 0n;try{return BigInt("0b"+t)}catch{return 0n}}function He(t){if(t.length===0)return 0n;try{return BigInt("0o"+t)}catch{return 0n}}function Me(t){if(t.length===0)return 0n;try{return BigInt(t)}catch{return 0n}}function Mt(t,s){const i=s.type==="UnsignedIntType"||s.type==="UnsignedLongType"||s.type==="UnsignedLongLongType"||s.type==="UnsignedType"||s.type==="UnsignedCharType"||s.type==="UnsignedShortType";switch(t){case"QI":return i?{type:"UnsignedCharType"}:{type:"CharType"};case"HI":return i?{type:"UnsignedShortType"}:{type:"ShortType"};case"SI":return i?{type:"UnsignedIntType"}:{type:"IntType"};case"DI":return i?{type:"UnsignedLongLongType"}:{type:"LongLongType"};case"TI":return i?{type:"UnsignedInt128Type"}:{type:"Int128Type"}}}const C=1,D=2,R=4,V=8,G=16,y=32,W=64,et=128,st=256,Q=512,q=1024,ae=2048,re=4096,ce=8192,x=16384,X=32768,ut=65536,$=1<<17,it=1<<18;function oe(){return{flags:0,parsingAddressSpace:"Default",parsingAliasTarget:null,parsingVisibility:null,parsingSection:null,parsingCleanupFn:null,parsingSymver:null,parsingVectorSize:null,parsingExtVectorNelem:null,parsedAlignas:null,parsedAlignasType:null,parsedAlignmentSizeofType:null}}function Oe(t){let s=t;return s.startsWith("__")&&(s=s.slice(2)),s.endsWith("__")&&(s=s.slice(0,-2)),s.toLowerCase()}function he(t){return t.kind===e.Identifier&&typeof t.value=="string"?t.value:t.kind===e.Noreturn?"noreturn":t.kind===e.Inline?"inline":null}function Ft(t){for(const s of t)if((s.kind===e.StringLiteral||s.kind===e.WideStringLiteral||s.kind===e.Char16StringLiteral)&&typeof s.value=="string")return s.value;return null}function pe(t){for(const s of t){const i=he(s);if(i!==null)return i}return null}function Ot(t){for(const s of t)if(s.kind===e.IntLiteral||s.kind===e.UIntLiteral||s.kind===e.LongLiteral||s.kind===e.ULongLiteral||s.kind===e.LongLongLiteral||s.kind===e.ULongLongLiteral){if(typeof s.value=="number")return s.value;if(typeof s.bigValue=="bigint")return Number(s.bigValue)}return null}function We(t){if(t===null)return null;let s=t;switch(s.startsWith("__")&&(s=s.slice(2)),s.endsWith("__")&&(s=s.slice(0,-2)),s.toUpperCase()){case"QI":return"QI";case"HI":return"HI";case"SI":return"SI";case"DI":return"DI";case"TI":return"TI";default:return null}}class u{constructor(s){this.tokens=s,this.pos=0,this.typedefs=u.builtinTypedefs(),this.shadowedTypedefs=new Set,this.attrs=oe(),this.pragmaPackStack=[],this.pragmaPackAlign=null,this.pragmaVisibilityStack=[],this.pragmaDefaultVisibility=null,this.errorCount=0,this.enumConstants=new Map,this.unevaluableEnumConstants=new Set,this.structTagAlignments=new Map}static builtinTypedefs(){return new Set(["size_t","ssize_t","ptrdiff_t","wchar_t","wint_t","int8_t","int16_t","int32_t","int64_t","uint8_t","uint16_t","uint32_t","uint64_t","intptr_t","uintptr_t","intmax_t","uintmax_t","int_least8_t","int_least16_t","int_least32_t","int_least64_t","uint_least8_t","uint_least16_t","uint_least32_t","uint_least64_t","int_fast8_t","int_fast16_t","int_fast32_t","int_fast64_t","uint_fast8_t","uint_fast16_t","uint_fast32_t","uint_fast64_t","FILE","fpos_t","sig_atomic_t","time_t","clock_t","timer_t","clockid_t","off_t","pid_t","uid_t","gid_t","mode_t","dev_t","ino_t","nlink_t","blksize_t","blkcnt_t","ulong","ushort","uint","__u8","__u16","__u32","__u64","__s8","__s16","__s32","__s64","va_list","__builtin_va_list","__gnuc_va_list","locale_t","pthread_t","pthread_mutex_t","pthread_cond_t","pthread_key_t","pthread_attr_t","pthread_once_t","pthread_mutexattr_t","pthread_condattr_t","jmp_buf","sigjmp_buf","DIR","__Float32x4_t","__Float64x2_t","__SVFloat32_t","__SVFloat64_t","__SVBool_t","__SVInt8_t","__SVInt16_t","__SVInt32_t","__SVInt64_t","__SVUint8_t","__SVUint16_t","__SVUint32_t","__SVUint64_t","__SVFloat16_t"])}getAttrFlag(s){return(this.attrs.flags&s)!==0}setAttrFlag(s,i){i?this.attrs.flags|=s:this.attrs.flags&=~s}saveAttrFlags(){return this.attrs.flags}restoreAttrFlags(s){this.attrs.flags=s}atEof(){return this.pos>=this.tokens.length||this.tokens[this.pos].kind===e.Eof}peek(){return this.pos<this.tokens.length?this.tokens[this.pos].kind:e.Eof}peekToken(){return this.pos<this.tokens.length?this.tokens[this.pos]:{kind:e.Eof,start:0,end:0}}peekSpan(){if(this.pos<this.tokens.length){const s=this.tokens[this.pos];return{start:s.start,end:s.end}}return fe()}peekValue(){if(this.pos<this.tokens.length)return this.tokens[this.pos].value}advance(){if(this.pos<this.tokens.length){const s=this.tokens[this.pos];return this.pos++,s}return this.tokens[this.tokens.length-1]}consumeIf(s){return this.peek()===s?(this.advance(),!0):!1}expect(s){if(this.peek()===s){const n=this.peekSpan();return this.advance(),n}const i=this.peekSpan();return this.emitError(`expected '${s}' before '${this.peek()}'`,i),i}expectAfter(s,i){if(this.peek()===s){const a=this.peekSpan();return this.advance(),a}const n=this.peekSpan();return this.emitError(`expected '${s}' ${i} before '${this.peek()}'`,n),n}expectContext(s,i){return this.expectAfter(s,i)}expectClosing(s,i){if(this.peek()===s){const a=this.peekSpan();return this.advance(),a}const n=this.peekSpan();return this.emitError(`expected '${s}' before '${this.peek()}'`,n),n}emitError(s,i){this.errorCount++}skipGccExtensions(){for(;this.peek()===e.Extension;)this.advance()}skipCvQualifiers(){for(;this.peek()===e.Const||this.peek()===e.Volatile||this.peek()===e.Restrict||this.peek()===e.SegGs||this.peek()===e.SegFs||this.peek()===e.Attribute||this.peek()===e.Extension;)this.peek()===e.SegGs?(this.advance(),this.attrs.parsingAddressSpace="SegGs"):this.peek()===e.SegFs?(this.advance(),this.attrs.parsingAddressSpace="SegFs"):this.peek()===e.Attribute?this.parseGccAttributes():this.advance()}skipArrayQualifiers(){for(;this.peek()===e.Const||this.peek()===e.Volatile||this.peek()===e.Restrict||this.peek()===e.Static;)this.advance()}skipLabelAttributes(){for(;this.peek()===e.Attribute;)this.parseGccAttributes();this.consumeIf(e.Semicolon)}skipBalancedParens(){if(this.peek()!==e.LParen)return;this.advance();let s=1;for(;s>0&&!this.atEof();)this.peek()===e.LParen?s++:this.peek()===e.RParen&&s--,s>0&&this.advance();this.consumeIf(e.RParen)}parseGccAttributes(){if(this.peek()!==e.Attribute)return[!1,null,null,!1];let s=!1,i=null,n=null,a=!1;const r=o=>{i=i===null?o:Math.max(i,o)},c=()=>{if(!this.consumeIf(e.LParen))return[];const o=[];let h=1;for(;h>0&&!this.atEof();){const p=this.advance();if(p.kind===e.LParen){h++,o.push(p);continue}if(p.kind===e.RParen){h--,h>0&&o.push(p);continue}o.push(p)}return o};for(;this.peek()===e.Attribute;)if(this.advance(),!!this.consumeIf(e.LParen)){if(!this.consumeIf(e.LParen)){let o=1;for(;o>0&&!this.atEof();){const h=this.advance();h.kind===e.LParen?o++:h.kind===e.RParen&&o--}continue}for(;!this.atEof();){if(this.peek()===e.RParen){this.advance();break}if(this.peek()===e.Comma){this.advance();continue}const o=he(this.peekToken());if(o===null){this.advance();continue}this.advance();const h=Oe(o),p=this.peek()===e.LParen?c():[];switch(h){case"packed":s=!0;break;case"aligned":{const l=Ot(p);l!==null&&r(l);break}case"mode":case"vector_size":{if(h==="mode"){const l=We(pe(p));l!==null&&(n=l)}else{const l=Ot(p);l!==null&&(this.attrs.parsingVectorSize=l)}break}case"ext_vector_type":{const l=Ot(p);l!==null&&(this.attrs.parsingExtVectorNelem=l);break}case"common":a=!0;break;case"transparent_union":this.setAttrFlag(ut,!0);break;case"constructor":this.setAttrFlag(et,!0);break;case"destructor":this.setAttrFlag(st,!0);break;case"weak":this.setAttrFlag(Q,!0);break;case"used":this.setAttrFlag(q,!0);break;case"gnu_inline":this.setAttrFlag(ae,!0);break;case"always_inline":this.setAttrFlag(re,!0);break;case"noinline":this.setAttrFlag(ce,!0);break;case"noreturn":this.setAttrFlag(x,!0);break;case"error":this.setAttrFlag(X,!0);break;case"fastcall":this.setAttrFlag($,!0);break;case"naked":this.setAttrFlag(it,!0);break;case"alias":{const l=Ft(p);l!==null&&(this.attrs.parsingAliasTarget=l);break}case"visibility":{const l=Ft(p);l!==null&&(this.attrs.parsingVisibility=l);break}case"section":{const l=Ft(p);l!==null&&(this.attrs.parsingSection=l);break}case"cleanup":{const l=pe(p);l!==null&&(this.attrs.parsingCleanupFn=l);break}case"symver":{const l=Ft(p);l!==null&&(this.attrs.parsingSymver=l);break}}}this.consumeIf(e.RParen)}return[s,i,n,a]}parseAlignasArgument(){if(this.peek()!==e.LParen)return null;if(this.peekSpan(),this.advance(),this.peek()===e.RParen)return this.advance(),null;let s=1;for(;s>0&&!this.atEof();)this.peek()===e.LParen?s++:this.peek()===e.RParen&&s--,s>0&&this.advance();return this.consumeIf(e.RParen),null}isTypeSpecifier(){switch(this.peek()){case e.Void:case e.Char:case e.Short:case e.Int:case e.Long:case e.Float:case e.Double:case e.Signed:case e.Unsigned:case e.Struct:case e.Union:case e.Enum:case e.Typeof:case e.Bool:case e.Complex:case e.Atomic:case e.AutoType:case e.Int128:case e.UInt128:case e.Builtin:case e.Const:case e.Volatile:case e.Restrict:case e.Static:case e.Extern:case e.Typedef:case e.Register:case e.Auto:case e.Inline:case e.Noreturn:case e.ThreadLocal:case e.Attribute:case e.Extension:case e.Alignas:case e.SegGs:case e.SegFs:return!0;case e.Identifier:{const i=this.peekValue();return typeof i=="string"?this.typedefs.has(i)&&!this.shadowedTypedefs.has(i):!1}default:return!1}}isTypedefLabel(){return this.peek()!==e.Identifier?!1:this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.Colon}handlePragmaPackToken(){const s=this.peek();return s===e.PragmaPackSet||s===e.PragmaPackPush||s===e.PragmaPackPushOnly||s===e.PragmaPackPop||s===e.PragmaPackReset?(this.advance(),!0):!1}handlePragmaVisibilityToken(){const s=this.peek();return s===e.PragmaVisibilityPush||s===e.PragmaVisibilityPop?(this.advance(),!0):!1}parseStaticAssert(){const s=this.peekSpan();this.advance();let i=s.end;if(this.peek()===e.LParen){const n=this.peekSpan();this.skipBalancedParens(),i=n.end}if(this.peek()===e.Semicolon){const n=this.peekSpan();this.advance(),i=n.end}return{start:s.start,end:i}}parseLocalDeclaration(){for(;this.peek()!==e.Semicolon&&!this.atEof();)this.advance();return this.consumeIf(e.Semicolon),null}parseExpr(){return this.parseAssignmentExpr()}parseAssignmentExpr(){return this.parsePrimaryExpr()}parsePrimaryExpr(){const s=this.peekSpan(),i=this.advance(),n={start:{line:1,column:0},end:{line:1,column:0}};switch(i.kind){case e.IntLiteral:return{type:"IntLiteral",value:i.value??0,start:s.start,end:s.end,loc:n};case e.Identifier:return{type:"Identifier",name:i.value??"",start:s.start,end:s.end,loc:n};case e.StringLiteral:return{type:"StringLiteral",value:i.value??"",start:s.start,end:s.end,loc:n};default:return{type:"IntLiteral",value:0,start:s.start,end:s.end,loc:n}}}parseParamList(){const s=[];let i=!1;if(this.peek()!==e.LParen)return[s,i];for(this.advance();this.peek()!==e.RParen&&!this.atEof();){if(this.peek()===e.Ellipsis){this.advance(),i=!0;break}for(;this.peek()!==e.Comma&&this.peek()!==e.RParen&&!this.atEof();)this.advance();this.consumeIf(e.Comma)}return this.consumeIf(e.RParen),[s,i]}parseDeclaratorWithAttrs(){let s=null;const i=[];for(;this.consumeIf(e.Star);)i.push({kind:"Pointer"}),this.skipCvQualifiers();return this.peek()===e.Identifier&&(s=this.peekValue()??null,this.advance()),this.parseGccAttributes(),[s,i,null,!1,null,!1]}tryParseParenAbstractDeclarator(){const s=this.pos;this.advance();let i=0;for(;this.peek()===e.Star;)this.advance(),i++;if(i===0)return this.pos=s,null;const n=[];for(;this.peek()===e.LBracket;)this.advance(),this.peek()===e.RBracket?n.push(null):n.push(this.parseExpr()),this.consumeIf(e.RBracket);if(this.peek()===e.LParen){const a=this.pos;this.advance();let r=0;for(;this.peek()===e.Star;)this.advance(),r++;if(r>0&&this.peek()===e.RParen&&(this.advance(),this.peek()===e.LParen)){const[c,o]=this.parseParamList();return this.consumeIf(e.RParen),{kind:"NestedFnPtr",outerPtrDepth:i,innerPtrDepth:r,innerParams:c,innerVariadic:o}}this.pos=a}return this.consumeIf(e.RParen),{kind:"Simple",ptrDepth:i,arrayDims:n}}isParenDeclarator(){if(this.pos+1>=this.tokens.length)return!1;const s=this.tokens[this.pos+1].kind;return s===e.Star||s===e.Identifier||s===e.LParen||s===e.Caret}static alignofTypeSpec(s,i){return 4}static evalConstIntExprWithEnums(s,i,n){return null}static targetIs32bit(){return!1}}const f={start:{line:1,column:0},end:{line:1,column:0}};u.prototype.parseExpr=function(){const t=this.parseAssignmentExpr();if(this.peek()===e.Comma){const s=this.peekSpan();this.advance();const i=this.parseExpr();return{type:"CommaExpression",left:t,right:i,start:s.start,end:s.end,loc:f}}return t},u.prototype.parseAssignmentExpr=function(){const t=Wt.call(this);if(this.peek()===e.Assign){const i=this.peekSpan();this.advance();const n=this.parseAssignmentExpr();return{type:"AssignExpression",left:t,right:n,start:i.start,end:i.end,loc:f}}const s=this.compoundAssignOp();if(s!==null){const i=this.peekSpan();this.advance();const n=this.parseAssignmentExpr();return{type:"CompoundAssignExpression",operator:s,left:t,right:n,start:i.start,end:i.end,loc:f}}return t},u.prototype.compoundAssignOp=function(){switch(this.peek()){case e.PlusAssign:return"Add";case e.MinusAssign:return"Sub";case e.StarAssign:return"Mul";case e.SlashAssign:return"Div";case e.PercentAssign:return"Mod";case e.AmpAssign:return"BitAnd";case e.PipeAssign:return"BitOr";case e.CaretAssign:return"BitXor";case e.LessLessAssign:return"Shl";case e.GreaterGreaterAssign:return"Shr";default:return null}};function Wt(){const t=w.call(this,0);if(this.consumeIf(e.Question)){const s={start:t.start,end:t.end};if(this.peek()===e.Colon){this.expectContext(e.Colon,"in conditional expression");const a=Wt.call(this);return{type:"GnuConditionalExpression",condition:t,alternate:a,start:s.start,end:s.end,loc:f}}const i=this.parseExpr();this.expectContext(e.Colon,"in conditional expression");const n=Wt.call(this);return{type:"ConditionalExpression",condition:t,consequent:i,alternate:n,start:s.start,end:s.end,loc:f}}return t}function Qe(t,s){switch(s){case 0:return t===e.PipePipe?"LogicalOr":null;case 1:return t===e.AmpAmp?"LogicalAnd":null;case 2:return t===e.Pipe?"BitOr":null;case 3:return t===e.Caret?"BitXor":null;case 4:return t===e.Amp?"BitAnd":null;case 5:return t===e.EqualEqual?"Eq":t===e.BangEqual?"Ne":null;case 6:return t===e.Less?"Lt":t===e.LessEqual?"Le":t===e.Greater?"Gt":t===e.GreaterEqual?"Ge":null;case 7:return t===e.LessLess?"Shl":t===e.GreaterGreater?"Shr":null;case 8:return t===e.Plus?"Add":t===e.Minus?"Sub":null;case 9:return t===e.Star?"Mul":t===e.Slash?"Div":t===e.Percent?"Mod":null}}function w(t){let s=le.call(this,t),i;for(;(i=Qe(this.peek(),t))!==null;){const n=this.peekSpan();this.advance();const a=le.call(this,t);s={type:"BinaryExpression",operator:i,left:s,right:a,start:n.start,end:n.end,loc:f}}return s}function le(t){switch(t){case 0:return w.call(this,1);case 1:return w.call(this,2);case 2:return w.call(this,3);case 3:return w.call(this,4);case 4:return w.call(this,5);case 5:return w.call(this,6);case 6:return w.call(this,7);case 7:return w.call(this,8);case 8:return w.call(this,9);case 9:return this.parseCastExpr()}}u.prototype.parseCastExpr=function(){if(this.peek()===e.LParen){const t=this.pos,s=this.getAttrFlag(C),i=this.getAttrFlag(y),n=this.attrs.parsingVectorSize,a=this.attrs.parsingExtVectorNelem;if(this.attrs.parsingVectorSize=null,this.attrs.parsingExtVectorNelem=null,this.advance(),this.isTypeSpecifier()){const r=this.parseTypeSpecifier();if(r!==null){let c=this.parseAbstractDeclaratorSuffix(r);if(c=this.applyPendingVectorAttr(c),this.peek()===e.RParen){const o=this.peekSpan();if(this.advance(),this.peek()===e.LBrace){const p=this.parseInitializer(),l={type:"CompoundLiteralExpression",typeSpec:c,init:p,start:o.start,end:o.end,loc:f};return this.setAttrFlag(y,i),this.attrs.parsingVectorSize=n,this.attrs.parsingExtVectorNelem=a,this.parsePostfixOps(l)}const h=this.parseCastExpr();return this.setAttrFlag(y,i),this.attrs.parsingVectorSize=n,this.attrs.parsingExtVectorNelem=a,{type:"CastExpression",typeSpec:c,operand:h,start:o.start,end:o.end,loc:f}}}}this.pos=t,this.setAttrFlag(C,s),this.setAttrFlag(y,i),this.attrs.parsingVectorSize=n,this.attrs.parsingExtVectorNelem=a}return this.parseUnaryExpr()},u.prototype.parseUnaryExpr=function(){switch(this.peek()){case e.AmpAmp:{const t=this.peekSpan();if(this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.Identifier){const s=this.tokens[this.pos+1].value??"";return this.advance(),this.advance(),{type:"LabelAddrExpression",label:s,start:t.start,end:t.end,loc:f}}return this.parsePostfixExpr()}case e.RealPart:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"RealPart",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.ImagPart:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"ImagPart",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.PlusPlus:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"PreInc",operand:this.parseUnaryExpr(),start:t.start,end:t.end,loc:f}}case e.MinusMinus:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"PreDec",operand:this.parseUnaryExpr(),start:t.start,end:t.end,loc:f}}case e.Plus:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"Plus",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Minus:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"Neg",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Tilde:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"BitNot",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Bang:{const t=this.peekSpan();return this.advance(),{type:"UnaryExpression",operator:"LogicalNot",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Amp:{const t=this.peekSpan();return this.advance(),{type:"AddressOfExpression",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Star:{const t=this.peekSpan();return this.advance(),{type:"DerefExpression",operand:this.parseCastExpr(),start:t.start,end:t.end,loc:f}}case e.Sizeof:return this.parseSizeofExpr();case e.Alignof:{const t=this.peekSpan();this.advance();const s=this.peekSpan();if(this.expectContext(e.LParen,"after '_Alignof'"),this.isTypeSpecifier()){const n=this.parseTypeSpecifier();if(n!==null){let a=this.parseAbstractDeclaratorSuffix(n);return a=this.applyPendingVectorAttr(a),this.expectClosing(e.RParen,s),{type:"AlignofExpression",typeSpec:a,start:t.start,end:t.end,loc:f}}}const i=this.parseAssignmentExpr();return this.expectClosing(e.RParen,s),{type:"AlignofExprExpression",expr:i,start:t.start,end:t.end,loc:f}}case e.GnuAlignof:{const t=this.peekSpan();this.advance();const s=this.peekSpan();if(this.expectContext(e.LParen,"after '__alignof__'"),this.isTypeSpecifier()){const n=this.parseTypeSpecifier();if(n!==null){let a=this.parseAbstractDeclaratorSuffix(n);return a=this.applyPendingVectorAttr(a),this.expectClosing(e.RParen,s),{type:"GnuAlignofExpression",typeSpec:a,start:t.start,end:t.end,loc:f}}}const i=this.parseAssignmentExpr();return this.expectClosing(e.RParen,s),{type:"GnuAlignofExprExpression",expr:i,start:t.start,end:t.end,loc:f}}default:return this.parsePostfixExpr()}},u.prototype.parseSizeofExpr=function(){const t=this.peekSpan();if(this.advance(),this.peek()===e.LParen){const i=this.pos,n=this.getAttrFlag(C),a=this.getAttrFlag(y),r=this.attrs.parsingVectorSize,c=this.attrs.parsingExtVectorNelem;if(this.attrs.parsingVectorSize=null,this.attrs.parsingExtVectorNelem=null,this.advance(),this.isTypeSpecifier()){const o=this.parseTypeSpecifier();if(o!==null){let h=this.parseAbstractDeclaratorSuffix(o);if(h=this.applyPendingVectorAttr(h),this.peek()===e.RParen)return this.expect(e.RParen),this.setAttrFlag(y,a),this.attrs.parsingVectorSize=r,this.attrs.parsingExtVectorNelem=c,{type:"SizeofExpression",argument:{kind:"Type",typeSpec:h},start:t.start,end:t.end,loc:f}}}this.pos=i,this.setAttrFlag(C,n),this.setAttrFlag(y,a),this.attrs.parsingVectorSize=r,this.attrs.parsingExtVectorNelem=c}return{type:"SizeofExpression",argument:{kind:"Expr",expr:this.parseUnaryExpr()},start:t.start,end:t.end,loc:f}},u.prototype.parsePostfixExpr=function(){const t=this.parsePrimaryExpr();return this.parsePostfixOps(t)},u.prototype.parsePostfixOps=function(t){let s=t;for(;;)switch(this.peek()){case e.LParen:{const i=this.peekSpan();this.advance();const n=[];if(this.peek()!==e.RParen)for(n.push(this.parseAssignmentExpr());this.consumeIf(e.Comma);)n.push(this.parseAssignmentExpr());this.expectClosing(e.RParen,i),s={type:"FunctionCallExpression",callee:s,args:n,start:i.start,end:i.end,loc:f};continue}case e.LBracket:{const i=this.peekSpan();this.advance();const n=this.parseExpr();this.expectClosing(e.RBracket,i),s={type:"ArraySubscriptExpression",object:s,index:n,start:i.start,end:i.end,loc:f};continue}case e.Dot:{const i=this.peekSpan();this.advance();let n="";this.peek()===e.Identifier&&(n=this.peekValue()??"",this.advance()),s={type:"MemberAccessExpression",object:s,member:n,start:i.start,end:i.end,loc:f};continue}case e.Arrow:{const i=this.peekSpan();this.advance();let n="";this.peek()===e.Identifier&&(n=this.peekValue()??"",this.advance()),s={type:"PointerMemberAccessExpression",object:s,member:n,start:i.start,end:i.end,loc:f};continue}case e.PlusPlus:{const i=this.peekSpan();this.advance(),s={type:"PostfixExpression",operator:"PostInc",operand:s,start:i.start,end:i.end,loc:f};continue}case e.MinusMinus:{const i=this.peekSpan();this.advance(),s={type:"PostfixExpression",operator:"PostDec",operand:s,start:i.start,end:i.end,loc:f};continue}default:return s}},u.prototype.parsePrimaryExpr=function(){switch(this.peek()){case e.IntLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"IntLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.UIntLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"UIntLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.LongLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"LongLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.ULongLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"ULongLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.LongLongLiteral:{const s=this.peekToken().bigValue??BigInt(0),i=this.peekSpan();return this.advance(),{type:"LongLongLiteral",value:s,start:i.start,end:i.end,loc:f}}case e.ULongLongLiteral:{const s=this.peekToken().bigValue??BigInt(0),i=this.peekSpan();return this.advance(),{type:"ULongLongLiteral",value:s,start:i.start,end:i.end,loc:f}}case e.FloatLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"FloatLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.FloatLiteralF32:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"FloatLiteralF32",value:t,start:s.start,end:s.end,loc:f}}case e.FloatLiteralLongDouble:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"FloatLiteralLongDouble",value:t,f128Bytes:new Uint8Array(16),start:s.start,end:s.end,loc:f}}case e.ImaginaryLiteral:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"ImaginaryLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.ImaginaryLiteralF32:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"ImaginaryLiteralF32",value:t,start:s.start,end:s.end,loc:f}}case e.ImaginaryLiteralLongDouble:{const t=this.peekValue()??0,s=this.peekSpan();return this.advance(),{type:"ImaginaryLiteralLongDouble",value:t,f128Bytes:new Uint8Array(16),start:s.start,end:s.end,loc:f}}case e.StringLiteral:{let t=this.peekValue()??"";const s=this.peekSpan();this.advance();let i=!1,n=!1;for(;;)if(this.peek()===e.StringLiteral)t+=this.peekValue()??"",this.advance();else if(this.peek()===e.WideStringLiteral)t+=this.peekValue()??"",i=!0,this.advance();else if(this.peek()===e.Char16StringLiteral)t+=this.peekValue()??"",n=!0,this.advance();else break;return i?{type:"WideStringLiteral",value:t,start:s.start,end:s.end,loc:f}:n?{type:"Char16StringLiteral",value:t,start:s.start,end:s.end,loc:f}:{type:"StringLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.WideStringLiteral:{let t=this.peekValue()??"";const s=this.peekSpan();for(this.advance();this.peek()===e.StringLiteral||this.peek()===e.WideStringLiteral||this.peek()===e.Char16StringLiteral;)t+=this.peekValue()??"",this.advance();return{type:"WideStringLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.Char16StringLiteral:{let t=this.peekValue()??"";const s=this.peekSpan();this.advance();let i=!1;for(;;)if(this.peek()===e.StringLiteral||this.peek()===e.Char16StringLiteral)t+=this.peekValue()??"",this.advance();else if(this.peek()===e.WideStringLiteral)t+=this.peekValue()??"",i=!0,this.advance();else break;return i?{type:"WideStringLiteral",value:t,start:s.start,end:s.end,loc:f}:{type:"Char16StringLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.CharLiteral:{const t=this.peekValue()??"",s=this.peekSpan();return this.advance(),{type:"CharLiteral",value:t,start:s.start,end:s.end,loc:f}}case e.Identifier:{const t=this.peekValue()??"",s=this.peekSpan();return this.advance(),{type:"Identifier",name:t,start:s.start,end:s.end,loc:f}}case e.LParen:{const t=this.peekSpan();if(this.advance(),this.peek()===e.LBrace){const i=this.peekSpan(),n=this.parseCompoundStmt();return this.expectClosing(e.RParen,t),{type:"StmtExpression",body:n,start:i.start,end:i.end,loc:f}}const s=this.parseExpr();return this.expectClosing(e.RParen,t),s}case e.Generic:return this.parseGenericSelection();case e.Asm:{const t=this.peekSpan();return this.advance(),this.consumeIf(e.Volatile),this.peek()===e.LParen&&this.skipBalancedParens(),{type:"IntLiteral",value:0,start:t.start,end:t.end,loc:f}}case e.BuiltinVaArg:{const t=this.peekSpan();this.advance();const s=this.peekSpan();this.expectContext(e.LParen,"after '__builtin_va_arg'");const i=this.parseAssignmentExpr();this.expectContext(e.Comma,"between '__builtin_va_arg' arguments");const n=this.parseVaArgType();return this.expectClosing(e.RParen,s),{type:"VaArgExpression",expr:i,typeSpec:n,start:t.start,end:t.end,loc:f}}case e.BuiltinTypesCompatibleP:{const t=this.peekSpan();this.advance();const s=this.peekSpan();this.expectContext(e.LParen,"after '__builtin_types_compatible_p'");const i=this.parseVaArgType();this.expectContext(e.Comma,"between '__builtin_types_compatible_p' arguments");const n=this.parseVaArgType();return this.expectClosing(e.RParen,s),{type:"BuiltinTypesCompatiblePExpression",typeSpec1:i,typeSpec2:n,start:t.start,end:t.end,loc:f}}case e.Typeof:{const t=this.peekSpan();return this.advance(),this.peek()===e.LParen&&this.skipBalancedParens(),{type:"IntLiteral",value:0,start:t.start,end:t.end,loc:f}}case e.Builtin:{const t=this.peekSpan();return this.advance(),{type:"Identifier",name:"__builtin_va_list",start:t.start,end:t.end,loc:f}}case e.Extension:return this.advance(),this.parseCastExpr();default:{const t=this.peekSpan();return this.emitError(`expected expression before '${this.peek()}'`,t),this.advance(),{type:"IntLiteral",value:0,start:t.start,end:t.end,loc:f}}}},u.prototype.parseGenericSelection=function(){const t=this.peekSpan();this.advance();const s=this.peekSpan();this.expectContext(e.LParen,"after '_Generic'");const i=this.parseAssignmentExpr();this.expectContext(e.Comma,"after '_Generic' controlling expression");const n=[];for(;this.peek()!==e.RParen;){const a=this.getAttrFlag(y);this.setAttrFlag(y,!1);let r=null,c=!1;if(this.peek()===e.Default)this.advance();else{const h=this.parseTypeSpecifier();h!==null&&(c=this.getAttrFlag(y),r=this.parseAbstractDeclaratorSuffix(h))}this.setAttrFlag(y,a),this.expectContext(e.Colon,"in '_Generic' association");const o=this.parseAssignmentExpr();if(n.push({typeSpec:r,expr:o,isConst:c}),!this.consumeIf(e.Comma))break}return this.expectClosing(e.RParen,s),{type:"GenericSelectionExpression",controlling:i,associations:n,start:t.start,end:t.end,loc:f}},u.prototype.applyPendingVectorAttr=function(t){if(this.attrs.parsingVectorSize!==null){const s=this.attrs.parsingVectorSize;return this.attrs.parsingVectorSize=null,{type:"VectorType",element:t,totalBytes:s}}if(this.attrs.parsingExtVectorNelem!==null){const s=this.attrs.parsingExtVectorNelem;this.attrs.parsingExtVectorNelem=null;const i=this.estimateTypeSize(t);return{type:"VectorType",element:t,totalBytes:s*i}}return t},u.prototype.estimateTypeSize=function(t){switch(t.type){case"CharType":case"UnsignedCharType":case"BoolType":return 1;case"ShortType":case"UnsignedShortType":return 2;case"IntType":case"UnsignedIntType":case"SignedType":case"UnsignedType":return 4;case"LongType":case"UnsignedLongType":return 8;case"LongLongType":case"UnsignedLongLongType":return 8;case"FloatType":return 4;case"DoubleType":return 8;case"LongDoubleType":return 16;default:return 4}};function qe(){return{hasVoid:!1,hasBool:!1,hasFloat:!1,hasDouble:!1,hasComplex:!1,hasChar:!1,hasShort:!1,hasInt:!1,hasUnsigned:!1,hasSigned:!1,hasStruct:!1,hasUnion:!1,hasEnum:!1,hasTypeof:!1,longCount:0,typedefName:null}}u.prototype.parseTypeSpecifier=function(){this.skipGccExtensions();const t=qe(),s={value:null};let i=!1,n=!1;t:for(;;)switch(this.peek()){case e.Const:this.advance(),this.setAttrFlag(y,!0);continue;case e.Volatile:this.advance(),this.setAttrFlag(W,!0);continue;case e.Restrict:this.advance();continue;case e.Register:case e.Auto:this.advance(),n=!0;continue;case e.Noreturn:this.advance(),this.setAttrFlag(x,!0);continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;case e.AutoType:return this.advance(),{type:"AutoTypeType"};case e.Inline:this.advance(),this.setAttrFlag(G,!0);continue;case e.Static:this.advance(),this.setAttrFlag(D,!0),n=!0;continue;case e.Extern:this.advance(),this.setAttrFlag(R,!0),n=!0;continue;case e.Typedef:this.advance(),this.setAttrFlag(C,!0),n=!0;continue;case e.ThreadLocal:this.advance(),this.setAttrFlag(V,!0),n=!0;continue;case e.Complex:this.advance(),t.hasComplex=!0,i=!0;continue;case e.Attribute:{const[,r,c]=this.parseGccAttributes();c!==null&&(s.value=c),r!==null&&(this.attrs.parsedAlignas=this.attrs.parsedAlignas!==null?Math.max(this.attrs.parsedAlignas,r):r);continue}case e.Extension:this.advance();continue;case e.Atomic:{if(this.advance(),this.peek()===e.LParen){const r=this.peekSpan();this.advance();const c=this.getAttrFlag(y);this.setAttrFlag(y,!1);const o=this.parseTypeSpecifier();if(this.setAttrFlag(y,c),o!==null){const p=this.parseAbstractDeclaratorSuffix(o);return this.expectClosing(e.RParen,r),p}const h=this.peekSpan();for(this.emitError("expected type name in _Atomic(...)",h);this.peek()!==e.RParen&&this.peek()!==e.Eof;)this.advance();return this.consumeIf(e.RParen),{type:"IntType"}}continue}case e.Alignas:{this.advance();const r=this.parseAlignasArgument();r!==null&&(this.attrs.parsedAlignas=this.attrs.parsedAlignas!==null?Math.max(this.attrs.parsedAlignas,r):r);continue}case e.Void:this.advance(),t.hasVoid=!0,i=!0;break t;case e.Char:this.advance(),t.hasChar=!0,i=!0;break t;case e.Short:this.advance(),t.hasShort=!0,i=!0;continue;case e.Int:this.advance(),t.hasInt=!0,i=!0;continue;case e.Long:this.advance(),t.longCount++,i=!0;continue;case e.Float:this.advance(),t.hasFloat=!0,i=!0;break t;case e.Double:this.advance(),t.hasDouble=!0,i=!0;break t;case e.Bool:this.advance(),t.hasBool=!0,i=!0;break t;case e.Signed:this.advance(),t.hasSigned=!0,i=!0;continue;case e.Unsigned:this.advance(),t.hasUnsigned=!0,i=!0;continue;case e.Int128:return this.peekSpan(),this.advance(),t.hasUnsigned?{type:"UnsignedInt128Type"}:{type:"Int128Type"};case e.UInt128:return this.peekSpan(),this.advance(),{type:"UnsignedInt128Type"};case e.Struct:this.advance(),t.hasStruct=!0,i=!0;break t;case e.Union:this.advance(),t.hasUnion=!0,i=!0;break t;case e.Enum:this.advance(),t.hasEnum=!0,i=!0;break t;case e.Typeof:this.advance(),t.hasTypeof=!0,i=!0;break t;case e.Builtin:if(!i){t.typedefName="__builtin_va_list",this.advance(),i=!0;break t}break t;case e.Identifier:{const r=this.peekValue();if(typeof r=="string"&&this.typedefs.has(r)&&!this.shadowedTypedefs.has(r)&&!i){t.typedefName=r,this.advance(),i=!0;break t}break t}default:break t}if(this.collectTrailingSpecifiers(t,s),!i)return n?{type:"IntType"}:null;let a=this.resolveTypeFlags(t);return a=this.consumeTrailingQualifiers(a),s.value!==null&&(a=Mt(s.value,a)),a},u.prototype.collectTrailingSpecifiers=function(t,s){if(t.hasChar||t.hasShort||t.hasInt||t.longCount>0)for(;;)switch(this.peek()){case e.Signed:this.advance(),t.hasSigned=!0;continue;case e.Unsigned:this.advance(),t.hasUnsigned=!0;continue;case e.Int:this.advance(),t.hasInt=!0;continue;case e.Long:this.advance(),t.longCount++;continue;case e.Short:this.advance(),t.hasShort=!0;continue;case e.Char:this.advance(),t.hasChar=!0;continue;case e.Complex:this.advance(),t.hasComplex=!0;continue;case e.Const:case e.Volatile:case e.Restrict:this.advance();continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;case e.Static:this.advance(),this.setAttrFlag(D,!0);continue;case e.Extern:this.advance(),this.setAttrFlag(R,!0);continue;case e.Auto:case e.Register:this.advance();continue;case e.ThreadLocal:this.advance(),this.setAttrFlag(V,!0);continue;case e.Noreturn:this.advance(),this.setAttrFlag(x,!0);continue;case e.Inline:this.advance(),this.setAttrFlag(G,!0);continue;case e.Attribute:{const[,i,n]=this.parseGccAttributes();n!==null&&(s.value=n),i!==null&&(this.attrs.parsedAlignas=this.attrs.parsedAlignas!==null?Math.max(this.attrs.parsedAlignas,i):i);continue}case e.Extension:this.advance();continue;default:return}else if(t.hasFloat)for(;;)switch(this.peek()){case e.Complex:this.advance(),t.hasComplex=!0;continue;case e.Const:case e.Volatile:case e.Restrict:this.advance();continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;case e.Static:this.advance(),this.setAttrFlag(D,!0);continue;case e.Extern:this.advance(),this.setAttrFlag(R,!0);continue;case e.Auto:case e.Register:this.advance();continue;case e.ThreadLocal:this.advance(),this.setAttrFlag(V,!0);continue;case e.Noreturn:this.advance(),this.setAttrFlag(x,!0);continue;case e.Inline:this.advance(),this.setAttrFlag(G,!0);continue;case e.Extension:this.advance();continue;default:return}else if(t.hasDouble)for(;;)switch(this.peek()){case e.Long:this.advance(),t.longCount++;continue;case e.Complex:this.advance(),t.hasComplex=!0;continue;case e.Const:case e.Volatile:case e.Restrict:this.advance();continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;case e.Static:this.advance(),this.setAttrFlag(D,!0);continue;case e.Extern:this.advance(),this.setAttrFlag(R,!0);continue;case e.Auto:case e.Register:this.advance();continue;case e.ThreadLocal:this.advance(),this.setAttrFlag(V,!0);continue;case e.Noreturn:this.advance(),this.setAttrFlag(x,!0);continue;case e.Inline:this.advance(),this.setAttrFlag(G,!0);continue;case e.Extension:this.advance();continue;default:return}},u.prototype.resolveTypeFlags=function(t){return t.hasVoid?{type:"VoidType"}:t.hasBool?{type:"BoolType"}:t.hasFloat?t.hasComplex?{type:"ComplexFloatType"}:{type:"FloatType"}:t.hasDouble?t.hasComplex?t.longCount>0?{type:"ComplexLongDoubleType"}:{type:"ComplexDoubleType"}:t.longCount>0?{type:"LongDoubleType"}:{type:"DoubleType"}:t.hasComplex&&!t.hasStruct&&!t.hasUnion&&!t.hasEnum?{type:"ComplexDoubleType"}:t.hasStruct?this.parseStructOrUnion(!0):t.hasUnion?this.parseStructOrUnion(!1):t.hasEnum?this.parseEnumSpecifier():t.hasTypeof?this.parseTypeofSpecifier():t.typedefName!==null?{type:"TypedefNameType",name:t.typedefName}:t.hasChar?t.hasUnsigned?{type:"UnsignedCharType"}:{type:"CharType"}:t.hasShort?t.hasUnsigned?{type:"UnsignedShortType"}:{type:"ShortType"}:t.longCount>=2?t.hasUnsigned?{type:"UnsignedLongLongType"}:{type:"LongLongType"}:t.longCount===1?t.hasUnsigned?{type:"UnsignedLongType"}:{type:"LongType"}:t.hasUnsigned?{type:"UnsignedIntType"}:{type:"IntType"}},u.prototype.parseStructOrUnion=function(t){let[s,i,,]=this.parseGccAttributes(),n=null;this.peek()===e.Identifier&&(n=this.peekValue()??null,this.advance());const[a,r,,]=this.parseGccAttributes();s=s||a,r!==null&&(i=r);let c=null;if(this.peek()===e.LBrace){const g=this.getAttrFlag(y);c=this.parseStructFields(),this.setAttrFlag(y,g)}const[o,h,,]=this.parseGccAttributes();s=s||o,h!==null&&(i=h);const p=this.pragmaPackAlign,l=t?{type:"StructType",name:n,fields:c,isPacked:s,maxFieldAlign:p,structAligned:i}:{type:"UnionType",name:n,fields:c,isPacked:s,maxFieldAlign:p,structAligned:i};if(n!==null&&c!==null&&(l.type==="StructType"||l.type==="UnionType")){const g=u.alignofTypeSpec(l,null);this.structTagAlignments.set(n,g)}return l},u.prototype.parseEnumSpecifier=function(){let[t,,,]=this.parseGccAttributes(),s=null;this.peek()===e.Identifier&&(s=this.peekValue()??null,this.advance());const[i,,,]=this.parseGccAttributes();t=t||i;let n=null;this.peek()===e.LBrace&&(n=this.parseEnumVariants(),this.registerEnumConstants(n));const[a,,,]=this.parseGccAttributes();return t=t||a,{type:"EnumType",name:s,variants:n,isPacked:t}},u.prototype.parseTypeofSpecifier=function(){const t=this.peekSpan();this.expectContext(e.LParen,"after 'typeof'");const s=this.saveAttrFlags(),i=this.pos;if(this.isTypeSpecifier()){const a=this.parseTypeSpecifier();if(a!==null){const r=this.parseAbstractDeclaratorSuffix(a);if(this.peek()===e.RParen)return this.advance(),this.restoreAttrFlags(s),{type:"TypeofTypeType",typeSpec:r}}this.pos=i,this.restoreAttrFlags(s),this.expectContext(e.LParen,"after 'typeof'")}const n=this.parseExpr();return this.expectClosing(e.RParen,t),this.restoreAttrFlags(s),{type:"TypeofExprType",expr:n}},u.prototype.consumeTrailingQualifiers=function(t){let s=t;for(;;)switch(this.peek()){case e.Complex:{this.advance(),s.type==="FloatType"?s={type:"ComplexFloatType"}:s.type==="DoubleType"?s={type:"ComplexDoubleType"}:s.type==="LongDoubleType"?s={type:"ComplexLongDoubleType"}:s={type:"ComplexDoubleType"};continue}case e.Const:case e.Volatile:case e.Restrict:this.advance();continue;case e.Static:this.advance(),this.setAttrFlag(D,!0);continue;case e.Extern:this.advance(),this.setAttrFlag(R,!0);continue;case e.Auto:case e.Register:this.advance();continue;case e.ThreadLocal:this.advance(),this.setAttrFlag(V,!0);continue;case e.Noreturn:this.advance(),this.setAttrFlag(x,!0);continue;case e.Inline:this.advance(),this.setAttrFlag(G,!0);continue;case e.Attribute:{const[,i]=this.parseGccAttributes();i!==null&&(this.attrs.parsedAlignas=this.attrs.parsedAlignas!==null?Math.max(this.attrs.parsedAlignas,i):i);continue}case e.Extension:this.advance();continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;default:return s}},u.prototype.parseStructFields=function(){const t=[],s=this.peekSpan();for(this.expectContext(e.LBrace,"for struct/union body");this.peek()!==e.RBrace&&this.peek()!==e.Eof;){if(this.skipGccExtensions(),this.peek()===e.Semicolon){this.advance();continue}if(this.peek()===e.StaticAssert){this.parseStaticAssert();continue}const i=this.parseTypeSpecifier();if(i!==null){if(this.peek()===e.Semicolon){const n=this.attrs.parsedAlignas;this.attrs.parsedAlignas=null,t.push({typeSpec:i,name:null,bitWidth:null,derived:[],alignment:n,isPacked:!1})}else this.parseStructFieldDeclarators(i,t);this.skipGccExtensions(),this.expectAfter(e.Semicolon,"after struct field declaration")}else this.advance()}return this.expectClosing(e.RBrace,s),t},u.prototype.parseStructFieldDeclarators=function(t,s){let i=this.attrs.parsedAlignas;this.attrs.parsedAlignas=null;const n={value:i};for(this.consumeStructFieldQualifiers(n),i=n.value;;){if(this.peek()===e.Colon){this.advance();const A=this.parseAssignmentExpr();if(s.push({typeSpec:t,name:null,bitWidth:A,derived:[],alignment:i,isPacked:!1}),!this.consumeIf(e.Comma))break;continue}const[a,r,,,c,o]=this.parseDeclaratorWithAttrs();let h=null;this.consumeIf(e.Colon)&&(h=this.parseAssignmentExpr());const[p,l]=this.parseGccAttributes(),g=c??l??i,S=o||p,[m,d]=this.foldSimpleDerived(t,r);if(s.push({typeSpec:m,name:a,bitWidth:h,derived:d,alignment:g,isPacked:S}),!this.consumeIf(e.Comma))break}},u.prototype.consumeStructFieldQualifiers=function(t){for(;;)switch(this.peek()){case e.Const:case e.Volatile:case e.Restrict:this.advance();continue;case e.SegGs:this.advance(),this.attrs.parsingAddressSpace="SegGs";continue;case e.SegFs:this.advance(),this.attrs.parsingAddressSpace="SegFs";continue;case e.Alignas:{this.advance();const s=this.parseAlignasArgument();s!==null&&(t.value=t.value!==null?Math.max(t.value,s):s);continue}case e.Attribute:{const[,s]=this.parseGccAttributes();s!==null&&(t.value=s);continue}case e.Extension:this.advance();continue;default:return}},u.prototype.foldSimpleDerived=function(t,s){if(s.some(r=>r.kind==="Function"||r.kind==="FunctionPointer"))return[t,[...s]];if(s.length===0)return[t,[]];let n=t,a=0;for(;a<s.length;){const r=s[a];if(r.kind==="Pointer")n={type:"PointerType",base:n,addressSpace:"Default"},a++;else if(r.kind==="Array"){const c=a;for(;a<s.length&&s[a].kind==="Array";)a++;for(let o=a-1;o>=c;o--){const h=s[o];n={type:"ArrayType",element:n,size:h.size}}}else a++}return[n,[]]},u.prototype.parseEnumVariants=function(){const t=[],s=this.peekSpan();for(this.expectContext(e.LBrace,"for enum body");this.peek()!==e.RBrace&&this.peek()!==e.Eof;)if(this.peek()===e.Identifier){const i=this.peekValue()??"";this.advance();let n=null;this.consumeIf(e.Assign)&&(n=this.parseAssignmentExpr()),t.push({name:i,value:n}),this.consumeIf(e.Comma)}else this.advance();return this.expectClosing(e.RBrace,s),t},u.prototype.registerEnumConstants=function(t){let s=0;for(const i of t){let n;if(i.value!==null){const a=this.structTagAlignments.size>0?this.structTagAlignments:null;n=u.evalConstIntExprWithEnums(i.value,this.enumConstants,a)}else n=s;n!==null?(this.enumConstants.set(i.name,n),s=n+1):(this.unevaluableEnumConstants.add(i.name),s=null)}},u.prototype.parseVaArgType=function(){const t=this.parseTypeSpecifier();if(t!==null){let i=t;for(;this.consumeIf(e.Star);)i={type:"PointerType",base:i,addressSpace:"Default"},this.skipCvQualifiers();if(this.peek()===e.LParen){const n=this.pos;if(this.advance(),this.consumeIf(e.Star)){for(;this.peek()!==e.RParen&&this.peek()!==e.Eof;)this.advance();this.consumeIf(e.RParen),this.peek()===e.LParen&&this.skipBalancedParens(),i={type:"PointerType",base:i,addressSpace:"Default"}}else this.pos=n}for(;this.peek()===e.LBracket;){const n=this.peekSpan();this.advance();let a=null;this.peek()!==e.RBracket&&(a=this.parseExpr()),this.expectClosing(e.RBracket,n),i={type:"ArrayType",element:i,size:a}}return i}const s=this.peekSpan();return this.emitError("expected type in __builtin_va_arg",s),{type:"IntType"}},u.prototype.parseAbstractDeclaratorSuffix=function(t){let s=t;for(this.skipCvQualifiers();this.consumeIf(e.Star);){const n=this.attrs.parsingAddressSpace;this.attrs.parsingAddressSpace="Default",s={type:"PointerType",base:s,addressSpace:n},this.skipCvQualifiers()}if(this.peek()===e.LParen){const n=this.pos,a=this.tryParseParenAbstractDeclarator();if(a!==null)if(a.kind==="Simple"){const{ptrDepth:r,arrayDims:c}=a;if(this.peek()===e.LParen){const[o,h]=this.parseParamList();s={type:"FunctionPointerType",returnType:s,params:o,variadic:h};for(let p=0;p<r-1;p++)s={type:"PointerType",base:s,addressSpace:"Default"};for(let p=c.length-1;p>=0;p--)s={type:"ArrayType",element:s,size:c[p]}}else if(this.peek()===e.LBracket||c.length>0){const o=[];for(;this.peek()===e.LBracket;){const h=this.peekSpan();this.advance();let p=null;this.peek()!==e.RBracket&&(p=this.parseExpr()),this.expectClosing(e.RBracket,h),o.push(p)}for(let h=o.length-1;h>=0;h--)s={type:"ArrayType",element:s,size:o[h]};for(let h=0;h<r;h++)s={type:"PointerType",base:s,addressSpace:"Default"};for(let h=c.length-1;h>=0;h--)s={type:"ArrayType",element:s,size:c[h]}}else for(let o=0;o<r;o++)s={type:"PointerType",base:s,addressSpace:"Default"}}else{const{outerPtrDepth:r,innerPtrDepth:c,innerParams:o,innerVariadic:h}=a;if(this.peek()===e.LParen){const[p,l]=this.parseParamList();for(let S=0;S<c-1;S++)s={type:"PointerType",base:s,addressSpace:"Default"};s={type:"FunctionPointerType",returnType:{type:"FunctionPointerType",returnType:s,params:p,variadic:l},params:o,variadic:h};for(let S=0;S<r-1;S++)s={type:"PointerType",base:s,addressSpace:"Default"}}else{const p=r+c;for(let l=0;l<p;l++)s={type:"PointerType",base:s,addressSpace:"Default"}}}else this.pos=n}const i=[];for(;this.peek()===e.LBracket;){const n=this.peekSpan();this.advance();let a=null;this.peek()!==e.RBracket&&(a=this.parseExpr()),this.expectClosing(e.RBracket,n),i.push(a)}for(let n=i.length-1;n>=0;n--)s={type:"ArrayType",element:s,size:i[n]};return s},u.prototype.parseCompoundStmt=function(){const t=this.peekSpan();this.expect(e.LBrace);const s=[],i=[],n=new Set(this.shadowedTypedefs),a=this.saveAttrFlags();for(;this.peek()===e.GnuLabel;){for(this.advance();;){if(this.peek()===e.Identifier){const c=this.peekValue()??"";i.push(c),this.advance()}if(!this.consumeIf(e.Comma))break}this.expectAfter(e.Semicolon,"after __label__ declaration")}for(;this.peek()!==e.RBrace&&this.peek()!==e.Eof;){for(this.skipGccExtensions();this.handlePragmaPackToken();)this.consumeIf(e.Semicolon);for(;this.handlePragmaVisibilityToken();)this.consumeIf(e.Semicolon);if(this.peek()===e.RBrace||this.peek()===e.Eof)break;if(this.peek()===e.GnuLabel){for(this.advance();;){if(this.peek()===e.Identifier){const c=this.peekValue()??"";i.push(c),this.advance()}if(!this.consumeIf(e.Comma))break}this.expectAfter(e.Semicolon,"after __label__ declaration");continue}if(this.peek()===e.StaticAssert)this.parseStaticAssert();else if(this.isTypeSpecifier()&&!this.isTypedefLabel()){const c=this.parseLocalDeclaration();c!==null&&s.push(c)}else{const c=this.parseStmt();s.push(c)}}this.expectClosing(e.RBrace,t),this.shadowedTypedefs=n,this.restoreAttrFlags(a);const r={start:{line:1,column:0},end:{line:1,column:0}};return{type:"CompoundStatement",items:s,localLabels:i,start:t.start,end:t.end,loc:r}},u.prototype.parseStmt=function(){const t={start:{line:1,column:0},end:{line:1,column:0}};if(this.skipGccExtensions(),this.isTypeSpecifier()&&!this.isTypedefLabel()){const s=this.parseLocalDeclaration();return s!==null?{type:"DeclarationStatement",declaration:s,start:s.start,end:s.end,loc:t}:{type:"ExpressionStatement",expr:null,start:0,end:0,loc:t}}switch(this.peek()){case e.Return:{const s=this.peekSpan();this.advance();let i=null;return this.peek()!==e.Semicolon&&(i=this.parseExpr()),this.expectAfter(e.Semicolon,"after return statement"),{type:"ReturnStatement",expr:i,start:s.start,end:s.end,loc:t}}case e.If:{const s=this.peekSpan();this.advance();const i=this.peekSpan();this.expectContext(e.LParen,"after 'if'");const n=this.parseExpr();this.expectClosing(e.RParen,i);const a=this.parseStmt();let r=null;return this.consumeIf(e.Else)&&(r=this.parseStmt()),{type:"IfStatement",condition:n,consequent:a,alternate:r,start:s.start,end:s.end,loc:t}}case e.While:{const s=this.peekSpan();this.advance();const i=this.peekSpan();this.expectContext(e.LParen,"after 'while'");const n=this.parseExpr();this.expectClosing(e.RParen,i);const a=this.parseStmt();return{type:"WhileStatement",condition:n,body:a,start:s.start,end:s.end,loc:t}}case e.Do:{const s=this.peekSpan();this.advance();const i=this.parseStmt();this.expectAfter(e.While,"at end of do-while statement");const n=this.peekSpan();this.expectContext(e.LParen,"after 'while'");const a=this.parseExpr();return this.expectClosing(e.RParen,n),this.expectAfter(e.Semicolon,"after do-while statement"),{type:"DoWhileStatement",body:i,condition:a,start:s.start,end:s.end,loc:t}}case e.For:return this.parseForStmt();case e.LBrace:return this.parseCompoundStmt();case e.Break:{const s=this.peekSpan();return this.advance(),this.expectAfter(e.Semicolon,"after break statement"),{type:"BreakStatement",start:s.start,end:s.end,loc:t}}case e.Continue:{const s=this.peekSpan();return this.advance(),this.expectAfter(e.Semicolon,"after continue statement"),{type:"ContinueStatement",start:s.start,end:s.end,loc:t}}case e.Switch:{const s=this.peekSpan();this.advance();const i=this.peekSpan();this.expectContext(e.LParen,"after 'switch'");const n=this.parseExpr();this.expectClosing(e.RParen,i);const a=this.parseStmt();return{type:"SwitchStatement",discriminant:n,body:a,start:s.start,end:s.end,loc:t}}case e.Case:{const s=this.peekSpan();this.advance();const i=this.parseExpr();if(this.consumeIf(e.Ellipsis)){const a=this.parseExpr();this.expectContext(e.Colon,"after 'case' expression");const r=this.parseStmt();return{type:"CaseRangeStatement",low:i,high:a,body:r,start:s.start,end:s.end,loc:t}}this.expectContext(e.Colon,"after 'case' expression");const n=this.parseStmt();return{type:"CaseStatement",test:i,body:n,start:s.start,end:s.end,loc:t}}case e.Default:{const s=this.peekSpan();return this.advance(),this.expectContext(e.Colon,"after 'default'"),{type:"DefaultStatement",body:this.parseStmt(),start:s.start,end:s.end,loc:t}}case e.Goto:{const s=this.peekSpan();if(this.advance(),this.peek()===e.Star){this.advance();const n=this.parseExpr();return this.expectAfter(e.Semicolon,"after goto statement"),{type:"GotoIndirectStatement",expr:n,start:s.start,end:s.end,loc:t}}let i="";return this.peek()===e.Identifier&&(i=this.peekValue()??"",this.advance()),this.expectAfter(e.Semicolon,"after goto statement"),{type:"GotoStatement",label:i,start:s.start,end:s.end,loc:t}}case e.Identifier:{const s=this.peekValue()??"",i=this.peekSpan();if(this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.Colon){this.advance(),this.advance(),this.skipLabelAttributes();const a=this.parseStmt();return{type:"LabelStatement",label:s,body:a,start:i.start,end:i.end,loc:t}}const n=this.parseExpr();return this.expectAfter(e.Semicolon,"after expression"),{type:"ExpressionStatement",expr:n,start:i.start,end:i.end,loc:t}}case e.Asm:return this.parseInlineAsm();case e.Semicolon:{const s=this.peekSpan();return this.advance(),{type:"ExpressionStatement",expr:null,start:s.start,end:s.end,loc:t}}default:{const s=this.peekSpan(),i=this.parseExpr();return this.expectAfter(e.Semicolon,"after expression"),{type:"ExpressionStatement",expr:i,start:s.start,end:s.end,loc:t}}}},u.prototype.parseForStmt=function(){const t={start:{line:1,column:0},end:{line:1,column:0}},s=this.peekSpan();this.advance();const i=this.peekSpan();this.expectContext(e.LParen,"after 'for'");const n=new Set(this.shadowedTypedefs),a=this.saveAttrFlags();let r=null;if(this.peek()===e.Semicolon)this.advance();else if(this.isTypeSpecifier()&&!this.isTypedefLabel()){const p=this.parseLocalDeclaration();p!==null&&(r={kind:"Declaration",declaration:p})}else r={kind:"Expression",expr:this.parseExpr()},this.expectAfter(e.Semicolon,"in 'for' statement");let c=null;this.peek()!==e.Semicolon&&(c=this.parseExpr()),this.expectAfter(e.Semicolon,"in 'for' statement");let o=null;this.peek()!==e.RParen&&(o=this.parseExpr()),this.expectClosing(e.RParen,i);const h=this.parseStmt();return this.shadowedTypedefs=n,this.restoreAttrFlags(a),{type:"ForStatement",init:r,condition:c,update:o,body:h,start:s.start,end:s.end,loc:t}},u.prototype.parseInlineAsm=function(){const t={start:{line:1,column:0},end:{line:1,column:0}},s=this.peekSpan();this.advance();let i=!1;for(;;)if(this.peek()===e.Volatile)this.advance();else if(this.peek()===e.Goto)this.advance(),i=!0;else if(this.peek()===e.Inline)this.advance();else break;const n=this.peekSpan();this.expectContext(e.LParen,"after 'asm'");const a=this.parseAsmString();let r=[],c=[],o=[],h=[];return this.consumeIf(e.Colon)&&(this.peek()!==e.Colon&&this.peek()!==e.RParen&&(r=this.parseAsmOperands()),this.consumeIf(e.Colon)&&(this.peek()!==e.Colon&&this.peek()!==e.RParen&&(c=this.parseAsmOperands()),this.consumeIf(e.Colon)&&(this.peek()!==e.Colon&&this.peek()!==e.RParen&&(o=this.parseAsmClobbers()),i&&this.consumeIf(e.Colon)&&this.peek()!==e.RParen&&(h=this.parseAsmGotoLabels())))),this.expectClosing(e.RParen,n),this.expectAfter(e.Semicolon,"after asm statement"),{type:"InlineAsmStatement",template:a,outputs:r,inputs:c,clobbers:o,gotoLabels:h,start:s.start,end:s.end,loc:t}},u.prototype.parseAsmString=function(){let t="";for(;this.peek()===e.StringLiteral||this.peek()===e.WideStringLiteral;){const s=this.peekValue();typeof s=="string"&&(t+=s),this.advance()}return t},u.prototype.parseAsmOperands=function(){const t=[];for(;t.push(this.parseOneAsmOperand()),!(!this.consumeIf(e.Comma)||this.peek()===e.Colon||this.peek()===e.RParen););return t},u.prototype.parseOneAsmOperand=function(){let t=null;if(this.peek()===e.LBracket){const a=this.peekSpan();this.advance(),this.peek()===e.Identifier&&(t=this.peekValue()??null,this.advance()),this.expectClosing(e.RBracket,a)}const s=this.parseAsmString(),i=this.peekSpan();this.expectContext(e.LParen,"in asm operand");const n=this.parseExpr();return this.expectClosing(e.RParen,i),{name:t,constraint:s,expr:n}},u.prototype.parseAsmClobbers=function(){const t=[];for(;;){const s=this.parseAsmString();if(s.length>0&&t.push(s),!this.consumeIf(e.Comma)||this.peek()===e.Colon||this.peek()===e.RParen)break}return t},u.prototype.parseAsmGotoLabels=function(){const t=[];for(;this.peek()===e.Identifier;){{const s=this.peekValue()??"";t.push(s),this.advance()}if(!this.consumeIf(e.Comma)||this.peek()===e.RParen)break}return t};function Xe(t){return F(t,null,null)}function F(t,s,i){switch(t.type){case"IntLiteral":return t.value;case"UIntLiteral":return t.value;case"LongLiteral":return t.value;case"ULongLiteral":return t.value;case"LongLongLiteral":return Number(t.value);case"ULongLongLiteral":return Number(t.value);case"CharLiteral":return typeof t.value=="string"?t.value.charCodeAt(0):0;case"Identifier":{if(s!==null){const n=s.get(t.name);if(n!==void 0)return n}return null}case"BinaryExpression":{const n=F(t.left,s,i),a=F(t.right,s,i);return n===null||a===null?null:$e(t.operator,n,a,t.left,t.right)}case"UnaryExpression":{const n=F(t.operand,s,i);if(n===null)return null;switch(t.operator){case"Neg":return-n|0;case"BitNot":{const a=~n;return I(t.operand)?(a&4294967295)>>>0:a}case"LogicalNot":return n===0?1:0;case"Plus":return n;default:return null}}case"ConditionalExpression":{const n=F(t.condition,s,i);return n===null?null:F(n!==0?t.consequent:t.alternate,s,i)}case"CastExpression":{const n=F(t.operand,s,i);if(n===null)return null;const a=qt(t.typeSpec);if(a===null)return null;const r=a*8;if(r>=64&&Qt(t.typeSpec))return null;if(r===0||r>=64)return n;const c=(1<<r)-1,o=n&c;if(Qt(t.typeSpec))return o>>>0;const h=1<<r-1;return o&h?o|~c:o}case"SizeofExpression":{if(t.argument.kind==="Type"){const n=qt(t.argument.typeSpec);if(n!==null)return n}return null}case"AlignofExpression":return It(t.typeSpec)?null:Tt(t.typeSpec,i);case"GnuAlignofExpression":return It(t.typeSpec)?null:je(t.typeSpec,i);case"AlignofExprExpression":case"GnuAlignofExprExpression":return null;case"CommaExpression":return F(t.left,s,i),F(t.right,s,i);default:return null}}function $e(t,s,i,n,a){switch(t){case"Add":return s+i|0;case"Sub":return s-i|0;case"Mul":return Math.imul(s,i);case"Div":return i!==0?s/i|0:null;case"Mod":return i!==0?s%i|0:null;case"Shl":return s<<(i&31);case"Shr":return I(n)?s>>>(i&31):s>>(i&31);case"BitAnd":return s&i;case"BitOr":return s|i;case"BitXor":return s^i;case"Eq":return s===i?1:0;case"Ne":return s!==i?1:0;case"Lt":return I(n)||I(a)?s>>>0<i>>>0?1:0:s<i?1:0;case"Le":return I(n)||I(a)?s>>>0<=i>>>0?1:0:s<=i?1:0;case"Gt":return I(n)||I(a)?s>>>0>i>>>0?1:0:s>i?1:0;case"Ge":return I(n)||I(a)?s>>>0>=i>>>0?1:0:s>=i?1:0;case"LogicalAnd":return s!==0&&i!==0?1:0;case"LogicalOr":return s!==0||i!==0?1:0;default:return null}}function I(t){switch(t.type){case"UIntLiteral":case"ULongLiteral":case"ULongLongLiteral":return!0;case"CastExpression":return Qt(t.typeSpec);case"UnaryExpression":return t.operator==="Plus"||t.operator==="Neg"?I(t.operand):!1;case"BinaryExpression":return I(t.left)||I(t.right);case"SizeofExpression":case"AlignofExpression":case"GnuAlignofExpression":case"AlignofExprExpression":case"GnuAlignofExprExpression":return!0;default:return!1}}function Qt(t){switch(t.type){case"UnsignedCharType":case"UnsignedShortType":case"UnsignedIntType":case"UnsignedType":case"UnsignedLongType":case"UnsignedLongLongType":case"UnsignedInt128Type":case"BoolType":case"PointerType":return!0;default:return!1}}const j=8;function qt(t){switch(t.type){case"VoidType":case"BoolType":case"CharType":case"UnsignedCharType":return 1;case"ShortType":case"UnsignedShortType":return 2;case"IntType":case"UnsignedIntType":case"SignedType":case"UnsignedType":case"FloatType":return 4;case"LongType":case"UnsignedLongType":return j;case"LongLongType":case"UnsignedLongLongType":case"DoubleType":return 8;case"PointerType":case"FunctionPointerType":return j;case"Int128Type":case"UnsignedInt128Type":return 16;case"LongDoubleType":return 16;case"ComplexFloatType":return 8;case"ComplexDoubleType":return 16;case"ComplexLongDoubleType":return 32;case"ArrayType":{if(t.size===null)return 0;const s=qt(t.element);if(s===null)return null;const i=Xe(t.size);return i===null?null:s*i}default:return null}}function It(t){switch(t.type){case"TypedefNameType":return!0;case"PointerType":return It(t.base);case"ArrayType":return It(t.element);default:return!1}}function Tt(t,s){switch(t.type){case"VoidType":case"BoolType":case"CharType":case"UnsignedCharType":return 1;case"ShortType":case"UnsignedShortType":return 2;case"IntType":case"UnsignedIntType":case"SignedType":case"UnsignedType":case"FloatType":return 4;case"LongType":case"UnsignedLongType":return j;case"LongLongType":case"UnsignedLongLongType":case"DoubleType":return 8;case"PointerType":case"FunctionPointerType":return j;case"Int128Type":case"UnsignedInt128Type":return 16;case"LongDoubleType":return 16;case"ComplexFloatType":return 4;case"ComplexDoubleType":return 8;case"ComplexLongDoubleType":return 16;case"ArrayType":return Tt(t.element,s);case"StructType":case"UnionType":{if(t.isPacked)return 1;let i=t.structAligned??0;if(t.fields)for(const n of t.fields){const a=n.alignment??Tt(n.typeSpec,s);i=Math.max(i,a)}else if(t.name&&s){const n=s.get(t.name);if(n!==void 0)return n}return i===0?j:i}case"EnumType":return 4;case"TypedefNameType":return j;default:return j}}function je(t,s){return Tt(t,s)}function Ye(t,s){const i=[];for(const n of t){const a=n.designators.findIndex(r=>r.kind==="Range");if(a>=0){const r=n.designators[a];if(r.kind==="Range"){const c=F(r.low,s,null),o=F(r.high,s,null);if(c!==null&&o!==null){const h={start:{line:1,column:0},end:{line:1,column:0}};for(let p=c;p<=o;p++){const l=[...n.designators];l[a]={kind:"Index",index:{type:"IntLiteral",value:p,start:0,end:0,loc:h}},i.push({designators:l,init:n.init})}continue}}i.push(n)}else i.push(n)}return i}const B={start:{line:1,column:0},end:{line:1,column:0}};function Dt(t=null){return{type:"Declaration",typeSpec:{type:"VoidType"},declarators:[],isStatic:!1,isExtern:!1,isTypedef:!1,isConst:!1,isVolatile:!1,isCommon:!1,isThreadLocal:!1,isTransparentUnion:!1,isInline:!1,alignment:null,alignasType:null,alignmentSizeofType:null,addressSpace:"Default",vectorSize:null,extVectorNelem:null,start:t?.start??0,end:t?.end??0,loc:B}}u.prototype.parseExternalDecl=function(){for(this.attrs=oe(),this.skipGccExtensions();this.handlePragmaPackToken();)this.consumeIf(e.Semicolon);for(;this.handlePragmaVisibilityToken();)this.consumeIf(e.Semicolon);if(this.atEof())return null;if(this.peek()===e.Asm){if(this.advance(),this.consumeIf(e.Volatile),this.peek()===e.LParen){this.advance();let P="";for(;;){const J=this.peek();if(J===e.StringLiteral)P+=this.peekValue(),this.advance();else{if(J===e.RParen||J===e.Eof)break;this.advance()}}if(this.peek()===e.RParen&&this.advance(),this.consumeIf(e.Semicolon),P.length>0){const J=this.peekSpan();return{type:"TopLevelAsm",asm:P,start:J.start,end:J.end,loc:B}}return Dt()}return this.consumeIf(e.Semicolon),Dt()}if(this.peek()===e.StaticAssert){const P=this.parseStaticAssert();return Dt(P)}const t=this.peekSpan();let s=this.parseTypeSpecifier();if(s===null)if(this.peek()===e.Identifier&&this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.LParen)s={type:"IntType"};else return null;const i=this.getAttrFlag(et),n=this.getAttrFlag(st);if(this.atEof()||this.peek()===e.Semicolon){const P=this.peek()===e.Semicolon?this.expectAfter(e.Semicolon,"after declaration"):t;return{type:"Declaration",typeSpec:s,declarators:[],isStatic:this.getAttrFlag(D),isExtern:this.getAttrFlag(R),isTypedef:this.getAttrFlag(C),isConst:this.getAttrFlag(y),isVolatile:this.getAttrFlag(W),isCommon:!1,isThreadLocal:this.getAttrFlag(V),isTransparentUnion:!1,isInline:!1,alignment:null,alignasType:null,alignmentSizeofType:null,addressSpace:this.attrs.parsingAddressSpace,vectorSize:this.attrs.parsingVectorSize,extVectorNelem:this.attrs.parsingExtVectorNelem,start:t.start,end:P.end,loc:B}}this.consumePostTypeQualifiers();const[a,r,c,o,h,p]=this.parseDeclaratorWithAttrs();let l=null;if(this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const P=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&(l=this.peekValue()??null,this.advance()),this.expectClosing(e.RParen,P)}const[g,S,m,d]=this.parseGccAttributes(),A=c??m;let k=o,v=this.attrs.parsedAlignas;const _=this.attrs.parsedAlignasType,z=this.attrs.parsedAlignmentSizeofType;for(const P of[h,S])P!=null&&(v=v===null?P:Math.max(v,P));const E=i||this.getAttrFlag(et),Rt=n||this.getAttrFlag(st),H=this.getAttrFlag(Q),ft=this.attrs.parsingAliasTarget,dt=this.attrs.parsingVisibility??this.pragmaDefaultVisibility??null,gt=this.attrs.parsingSection,mt=this.getAttrFlag(X),yt=this.getAttrFlag(x),M=this.attrs.parsingCleanupFn,Y=this.attrs.parsingSymver,Xt=this.getAttrFlag(q),nt=this.getAttrFlag($),kt=this.getAttrFlag(it),ue={isConstructor:E,isDestructor:Rt,isWeak:H,isErrorAttr:mt,isNoreturn:yt,isUsed:Xt,isFastcall:nt,isNaked:kt,aliasTarget:ft,visibility:dt,section:gt,asmRegister:l,cleanupFn:M,symver:Y};if(A!=null&&(s=Mt(A,s)),r.length>0&&r[r.length-1].kind==="Function"&&(this.peek()===e.LBrace||this.isTypeSpecifier()))return this.parseFunctionDef(s,a,r,t,ue);{const P={attrs:ue,alignment:v,alignasType:_,alignmentSizeofType:z,isCommon:k};return this.parseDeclarationRest(s,a,r,t,P)}},u.prototype.parseFunctionDef=function(t,s,i,n,a){this.setAttrFlag(C,!1);let r=[],c=!1;const o=i[i.length-1];o.kind==="Function"&&(r=[...o.params],c=o.variadic);const h=this.peek()!==e.LBrace,p=h?this.parseKrParams(r):r,l=this.getAttrFlag(D),g=this.getAttrFlag(G),S=this.getAttrFlag(R),m=this.getAttrFlag(ae),d=this.getAttrFlag(re),A=this.getAttrFlag(ce),k=this.buildReturnType(t,i),v=new Set(this.shadowedTypedefs);for(const E of p)E.name!==null&&this.typedefs.has(E.name)&&!this.shadowedTypedefs.has(E.name)&&this.shadowedTypedefs.add(E.name);this.setAttrFlag(x,!1);const _=this.parseCompoundStmt();this.shadowedTypedefs=v;const z={isStatic:l,isInline:g,isExtern:S,isGnuInline:m,isAlwaysInline:d,isNoinline:A,isConstructor:a.isConstructor,isDestructor:a.isDestructor,isWeak:a.isWeak,isUsed:a.isUsed,isFastcall:a.isFastcall,isNaked:a.isNaked,isNoreturn:a.isNoreturn,section:a.section,visibility:a.visibility,symver:a.symver};return{type:"FunctionDefinition",returnType:k,name:s??"",params:p,variadic:c,body:_,attrs:z,isKr:h,start:n.start,end:n.end,loc:B}},u.prototype.buildReturnType=function(t,s){let i=t;const n=s.findIndex(a=>a.kind==="Function");if(n>=0){for(let a=n+1;a<s.length;a++){const r=s[a];r.kind==="Array"?i={type:"ArrayType",element:i,size:r.size}:r.kind==="Pointer"&&(i={type:"PointerType",base:i,addressSpace:"Default"})}for(let a=0;a<n;a++){const r=s[a];r.kind==="Pointer"?i={type:"PointerType",base:i,addressSpace:"Default"}:r.kind==="Array"&&(i={type:"ArrayType",element:i,size:r.size})}}else for(const a of s)if(a.kind==="Pointer")i={type:"PointerType",base:i,addressSpace:"Default"};else break;return i},u.prototype.parseKrParams=function(t){const s=[...t];for(;this.isTypeSpecifier()&&this.peek()!==e.LBrace;){const i=this.parseTypeSpecifier();if(i===null)break;for(;;){const[n,a]=this.parseDeclaratorWithAttrs();if(n!==null){const[r,c]=this.applyKrDerivations(i,a);let o=0;if(c!==null){let h=!1,p=0;for(const l of a)l.kind==="FunctionPointer"||l.kind==="Function"?h=!0:l.kind==="Pointer"&&h&&p++;o=1+p}for(const h of s)if(h.name===n){h.typeSpec=r,h.fptrParams=c,h.fptrInnerPtrDepth=o;break}}if(!this.consumeIf(e.Comma))break}this.expectAfter(e.Semicolon,"after parameter declaration")}return s},u.prototype.applyKrDerivations=function(t,s){let i=t;const n=s.find(r=>r.kind==="FunctionPointer");if(n&&n.kind==="FunctionPointer"){const r=s.filter(c=>c.kind==="Pointer").length;for(let c=0;c<Math.max(0,r-1);c++)i={type:"PointerType",base:i,addressSpace:"Default"};return i={type:"PointerType",base:i,addressSpace:"Default"},[i,n.params]}for(const r of s)r.kind==="Pointer"&&(i={type:"PointerType",base:i,addressSpace:"Default"});const a=s.filter(r=>r.kind==="Array").map(r=>r.size);if(a.length>0){for(let r=a.length-1;r>=1;r--)i={type:"ArrayType",element:i,size:a[r]};i={type:"PointerType",base:i,addressSpace:"Default"}}for(const r of s)r.kind==="Function"&&(i={type:"PointerType",base:i,addressSpace:"Default"});return[i,null]},u.prototype.parseDeclarationRest=function(t,s,i,n,a){const r=[],c=this.consumeIf(e.Assign)?this.parseInitializer():null,o=a.attrs.section;r.push({type:"InitDeclarator",name:s??"",derived:i,init:c,attrs:{...a.attrs},start:n.start,end:n.end,loc:B});let h=null;if(this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const _=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&(h=this.peekValue()??null,this.advance()),this.expectClosing(e.RParen,_)}const[p,l,g,S]=this.parseGccAttributes(),m=r[r.length-1];for(h!==null&&(m.attrs.asmRegister=h),this.getAttrFlag(et)&&(m.attrs.isConstructor=!0),this.getAttrFlag(st)&&(m.attrs.isDestructor=!0),this.getAttrFlag(Q)&&(m.attrs.isWeak=!0),this.attrs.parsingAliasTarget&&(m.attrs.aliasTarget=this.attrs.parsingAliasTarget),this.attrs.parsingVisibility&&(m.attrs.visibility=this.attrs.parsingVisibility),this.attrs.parsingSection&&(m.attrs.section=this.attrs.parsingSection),this.attrs.parsingCleanupFn&&(m.attrs.cleanupFn=this.attrs.parsingCleanupFn),this.getAttrFlag(q)&&(m.attrs.isUsed=!0),this.getAttrFlag(x)&&(m.attrs.isNoreturn=!0),this.getAttrFlag($)&&(m.attrs.isFastcall=!0),this.getAttrFlag(it)&&(m.attrs.isNaked=!0),this.getAttrFlag(X)&&(m.attrs.isErrorAttr=!0),this.setAttrFlag(Q,!1),this.attrs.parsingAliasTarget=null,this.attrs.parsingVisibility=null,this.attrs.parsingSection=null,this.setAttrFlag(X,!1),this.setAttrFlag(x,!1),this.attrs.parsingCleanupFn=null,this.setAttrFlag(q,!1),this.setAttrFlag($,!1),this.setAttrFlag(it,!1),l!=null&&(a.alignment=a.alignment===null?l:Math.max(a.alignment,l));this.consumeIf(e.Comma);){const[_,z]=this.parseDeclaratorWithAttrs();let E=null;if(this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const kt=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&(E=this.peekValue()??null,this.advance()),this.expectClosing(e.RParen,kt)}this.parseGccAttributes();const Rt=this.getAttrFlag(Q),H=this.attrs.parsingAliasTarget??null,ft=this.attrs.parsingVisibility??this.pragmaDefaultVisibility??null,dt=this.attrs.parsingSection??o??null,gt=this.attrs.parsingCleanupFn??null,mt=this.getAttrFlag(q),yt=this.getAttrFlag(x),M=this.getAttrFlag(X);this.setAttrFlag(Q,!1),this.setAttrFlag(q,!1),this.setAttrFlag($,!1),this.setAttrFlag(it,!1),this.setAttrFlag(x,!1),this.setAttrFlag(X,!1);const Y=this.consumeIf(e.Assign)?this.parseInitializer():null,Xt=this.getAttrFlag($);if(r.push({type:"InitDeclarator",name:_??"",derived:z,init:Y,attrs:{isConstructor:this.getAttrFlag(et),isDestructor:this.getAttrFlag(st),isWeak:Rt,isErrorAttr:M,isNoreturn:yt,isUsed:mt,isFastcall:Xt,isNaked:!1,aliasTarget:H,visibility:ft,section:dt,asmRegister:E,cleanupFn:gt,symver:null},start:n.start,end:n.end,loc:B}),this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const kt=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&(r[r.length-1].attrs.asmRegister=this.peekValue()??null,this.advance()),this.expectClosing(e.RParen,kt)}const[,nt]=this.parseGccAttributes();nt!=null&&(a.alignment=a.alignment===null?nt:Math.max(a.alignment,nt))}const d=this.getAttrFlag(C),A=this.getAttrFlag(ut);this.setAttrFlag(ut,!1),this.registerTypedefs(r);const k=this.expectAfter(e.Semicolon,"after declaration");return{type:"Declaration",typeSpec:t,declarators:r,isStatic:this.getAttrFlag(D),isExtern:this.getAttrFlag(R),isTypedef:d,isConst:this.getAttrFlag(y),isVolatile:this.getAttrFlag(W),isCommon:a.isCommon,isThreadLocal:this.getAttrFlag(V),isTransparentUnion:A,isInline:this.getAttrFlag(G),alignment:a.alignment,alignasType:a.alignasType,alignmentSizeofType:a.alignmentSizeofType,addressSpace:this.attrs.parsingAddressSpace,vectorSize:this.attrs.parsingVectorSize,extVectorNelem:this.attrs.parsingExtVectorNelem,start:n.start,end:k.end,loc:B}},u.prototype.parseLocalDeclaration=function(){const t=this.saveAttrFlags();if(this.setAttrFlag(D,!1),this.setAttrFlag(R,!1),this.setAttrFlag(C,!1),this.setAttrFlag(G,!1),this.setAttrFlag(V,!1),this.setAttrFlag(y,!1),this.setAttrFlag(W,!1),this.attrs.parsingAddressSpace="Default",this.skipGccExtensions(),this.peek()===e.StaticAssert){const d=this.parseStaticAssert();return this.restoreAttrFlags(t),Dt(d)}const s=this.peekSpan();let i=this.parseTypeSpecifier();if(i===null)return this.restoreAttrFlags(t),null;if(this.peek()===e.Semicolon){const d=this.peekSpan();this.advance();const A=this.getAttrFlag(D),k=this.getAttrFlag(R),v=this.getAttrFlag(C),_=this.getAttrFlag(y),z=this.getAttrFlag(W),E=this.getAttrFlag(V);return this.restoreAttrFlags(t),{type:"Declaration",typeSpec:i,declarators:[],isStatic:A,isExtern:k,isTypedef:v,isConst:_,isVolatile:z,isCommon:!1,isThreadLocal:E,isTransparentUnion:!1,isInline:!1,alignment:null,alignasType:null,alignmentSizeofType:null,addressSpace:"Default",vectorSize:null,extVectorNelem:null,start:s.start,end:d.end,loc:B}}this.consumePostTypeQualifiers();const n=this.getAttrFlag(D),a=this.getAttrFlag(R),r=[];let c=this.attrs.parsedAlignas??null,o=null;for(;;){const[d,A,k,v,_,z]=this.parseDeclaratorWithAttrs();let E=null;if(this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const Y=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&(E=this.peekValue()??null,this.advance()),this.expectClosing(e.RParen,Y)}const[Rt,H,ft]=this.parseGccAttributes(),dt=this.attrs.parsingCleanupFn;this.attrs.parsingCleanupFn=null;const gt=this.attrs.parsingSection;this.attrs.parsingSection=null,o=o??k??ft,_!=null&&(c=c===null?_:Math.max(c,_)),H!=null&&(c=c===null?H:Math.max(c,H));const mt=this.consumeIf(e.Assign)?this.parseInitializer():null,yt={isConstructor:this.getAttrFlag(et),isDestructor:this.getAttrFlag(st),isWeak:this.getAttrFlag(Q),isErrorAttr:this.getAttrFlag(X),isNoreturn:this.getAttrFlag(x),isUsed:this.getAttrFlag(q),isFastcall:this.getAttrFlag($),isNaked:this.getAttrFlag(it),aliasTarget:this.attrs.parsingAliasTarget??null,visibility:this.attrs.parsingVisibility??this.pragmaDefaultVisibility??null,section:gt??null,asmRegister:E,cleanupFn:dt??null,symver:this.attrs.parsingSymver??null};if(r.push({type:"InitDeclarator",name:d??"",derived:A,init:mt,attrs:yt,start:s.start,end:s.end,loc:B}),this.peek()===e.Asm&&(this.advance(),this.peek()===e.LParen)){const Y=this.peekSpan();this.advance(),this.peek()===e.StringLiteral&&this.advance(),this.expectClosing(e.RParen,Y)}const[,M]=this.parseGccAttributes();if(M!=null&&(c=c===null?M:Math.max(c,M)),!this.consumeIf(e.Comma))break}o!==null&&(i=Mt(o,i));const h=this.getAttrFlag(C);if(h){for(const d of r)d.name&&d.name.length>0&&(this.typedefs.add(d.name),this.shadowedTypedefs.delete(d.name));this.setAttrFlag(C,!1)}else for(const d of r)d.name&&d.name.length>0&&this.typedefs.has(d.name)&&this.shadowedTypedefs.add(d.name);const p=this.expectAfter(e.Semicolon,"after declaration");if(this.attrs.parsedAlignas!==null){const d=this.attrs.parsedAlignas;c=c===null?d:Math.max(c,d),this.attrs.parsedAlignas=null}const l=this.attrs.parsedAlignasType;this.attrs.parsedAlignasType=null;const g=this.attrs.parsedAlignmentSizeofType;this.attrs.parsedAlignmentSizeofType=null;const S=this.getAttrFlag(ut);this.setAttrFlag(ut,!1);const m={type:"Declaration",typeSpec:i,declarators:r,isStatic:n,isExtern:a,isTypedef:h,isConst:this.getAttrFlag(y),isVolatile:this.getAttrFlag(W),isCommon:!1,isThreadLocal:this.getAttrFlag(V),isTransparentUnion:S,isInline:!1,alignment:c,alignasType:l??null,alignmentSizeofType:g??null,addressSpace:this.attrs.parsingAddressSpace,vectorSize:this.attrs.parsingVectorSize,extVectorNelem:this.attrs.parsingExtVectorNelem,start:s.start,end:p.end,loc:B};return this.restoreAttrFlags(t),m},u.prototype.parseInitializer=function(){if(this.peek()!==e.LBrace)return{kind:"Expr",expr:this.parseAssignmentExpr()};const t=this.peekSpan();this.advance();const s=[];for(;this.peek()!==e.RBrace&&!this.atEof();){const a=[];for(;this.peek()===e.LBracket||this.peek()===e.Dot;)if(this.peek()===e.LBracket){const c=this.peekSpan();this.advance();const o=this.parseAssignmentExpr();if(this.peek()===e.Ellipsis){this.advance();const h=this.parseAssignmentExpr();this.expectClosing(e.RBracket,c),a.push({kind:"Range",low:o,high:h})}else this.expectClosing(e.RBracket,c),a.push({kind:"Index",index:o})}else if(this.advance(),this.peek()===e.Identifier){const c=this.peekValue();this.advance(),a.push({kind:"Field",name:c})}else this.advance();if(a.length===0&&this.peek()===e.Identifier&&this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.Colon){const c=this.peekValue();this.advance(),this.advance(),a.push({kind:"Field",name:c})}a.length>0&&this.consumeIf(e.Assign);const r=this.parseInitializer();if(s.push({designators:a,init:r}),!this.consumeIf(e.Comma))break}this.expectClosing(e.RBrace,t);const i=this.enumConstants.size>0?this.enumConstants:null;return{kind:"List",items:Ye(s,i)}},u.prototype.parseStaticAssert=function(){const t=this.peekSpan();this.advance();const s=this.peekSpan();this.expectContext(e.LParen,"after '_Static_assert'");const i=this.parseAssignmentExpr();let n=null;if(this.consumeIf(e.Comma)){let p="";for(;this.peek()===e.StringLiteral;)p+=this.peekValue(),this.advance();n=p}let r=this.expectClosing(e.RParen,s).end;if(this.peek()===e.Semicolon){const p=this.peekSpan();this.advance(),r=p.end}const c=this.enumConstants.size>0?this.enumConstants:null,o=this.structTagAlignments.size>0?this.structTagAlignments:null,h=F(i,c,o);if(h!==null&&h===0){const p={start:i.start,end:i.end},l=n!==null?`static assertion failed: "${n}"`:"static assertion failed";this.emitError(l,p)}return{start:t.start,end:r}},u.prototype.consumePostTypeQualifiers=function(){for(;;)switch(this.peek()){case e.Static:this.setAttrFlag(D,!0),this.advance();break;case e.Extern:this.setAttrFlag(R,!0),this.advance();break;case e.Typedef:this.setAttrFlag(C,!0),this.advance();break;case e.Inline:this.setAttrFlag(G,!0),this.advance();break;case e.ThreadLocal:this.setAttrFlag(V,!0),this.advance();break;case e.Const:this.setAttrFlag(y,!0),this.advance();break;case e.Volatile:this.setAttrFlag(W,!0),this.advance();break;case e.Register:this.advance();break;case e.Restrict:this.advance();break;case e.Noreturn:this.setAttrFlag(x,!0),this.advance();break;case e.Attribute:case e.Extension:this.skipGccExtensions();break;default:return}},u.prototype.registerTypedefs=function(t){if(this.getAttrFlag(C))for(const s of t)s.name&&s.name.length>0&&(this.typedefs.add(s.name),this.shadowedTypedefs.delete(s.name))},u.prototype.skipArrayDimensions=function(){for(;this.peek()===e.LBracket;){for(this.advance();this.peek()!==e.RBracket&&!this.atEof();)this.advance();this.consumeIf(e.RBracket)}},u.prototype.parseDeclarator=function(){const[t,s]=this.parseDeclaratorWithAttrs();return[t,s]},u.prototype.parseDeclaratorWithAttrs=function(){const t=[];let s=null,i=!1;const[n,a]=this.parseGccAttributes();for(i=i||n,a!==null&&(s=s===null?a:Math.max(s,a));this.consumeIf(e.Star);)t.push({kind:"Pointer"}),this.skipCvQualifiers(),this.skipGccExtensions();let r=null,c=[];const o=this.peek();if(o===e.Identifier)r=this.peekValue(),this.advance();else if(o===e.LParen&&this.isParenDeclarator()){const A=this.pos;this.advance();const[k,v]=this.parseDeclarator();this.consumeIf(e.RParen)?(r=k,c=v):(this.pos=A,r=null,c=[])}const h=[];for(;;){const A=this.peek();if(A===e.LBracket){const k=this.peekSpan();this.advance(),this.skipArrayQualifiers();let v=null;this.peek()===e.RBracket||(this.peek()===e.Star&&this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.RBracket?this.advance():v=this.parseExpr()),this.expectClosing(e.RBracket,k),h.push({kind:"Array",size:v})}else if(A===e.LParen){const[k,v]=this.parseParamList();h.push({kind:"Function",params:k,variadic:v})}else break}const p=this.combineDeclaratorParts(t,c,h),[l,g,S,m]=this.parseGccAttributes();i=i||l;let d=null;return s!==null&&g!==null?d=Math.max(s,g):s!==null?d=s:g!==null&&(d=g),[r,p,S,m,d,i]},u.prototype.isParenDeclarator=function(){if(this.pos+1>=this.tokens.length)return!1;const t=this.tokens[this.pos+1];switch(t.kind){case e.Star:case e.Caret:case e.LParen:case e.LBracket:case e.Attribute:case e.Extension:return!0;case e.Identifier:{const s=t.value;return!this.typedefs.has(s)||this.shadowedTypedefs.has(s)}case e.RParen:case e.Ellipsis:return!1;case e.Void:case e.Char:case e.Short:case e.Int:case e.Long:case e.Float:case e.Double:case e.Signed:case e.Unsigned:case e.Struct:case e.Union:case e.Enum:case e.Const:case e.Volatile:case e.Static:case e.Extern:case e.Register:case e.Typedef:case e.Inline:case e.Bool:case e.Typeof:case e.Noreturn:case e.Restrict:case e.Complex:case e.Atomic:case e.Auto:case e.Alignas:case e.Builtin:return!1;default:return!1}},u.prototype.combineDeclaratorParts=function(t,s,i){if(s.length===0&&i.length===0)return t;if(s.length===0)return[...t,...i];const n=s.every(p=>p.kind==="Pointer"||p.kind==="Array"),a=s.some(p=>p.kind==="Pointer"),r=i.length>0&&i[0].kind==="Function";if(n&&a&&r&&i.length===1){const p=[...t],l=s.filter(m=>m.kind==="Pointer").length,g=l>0?l-1:0;p.push({kind:"Pointer"});const S=i[0];S.kind==="Function"&&p.push({kind:"FunctionPointer",params:S.params,variadic:S.variadic});for(let m=0;m<g;m++)p.push({kind:"Pointer"});for(const m of s)m.kind==="Array"&&p.push({...m});return p}const c=i.every(p=>p.kind==="Array");if(n&&a&&c){const p=Je(s,g=>g.kind==="Pointer"),l=[...t];for(let g=0;g<p;g++)s[g].kind==="Array"&&l.push({...s[g]});l.push(...i);for(let g=0;g<=p;g++)s[g].kind==="Pointer"&&l.push({...s[g]});for(let g=p+1;g<s.length;g++)l.push({...s[g]});return l}const o=s.length>0&&s[0].kind==="Pointer",h=s.some(p=>p.kind==="FunctionPointer");if(o&&h&&r){const p=[...t,...s];for(const l of i)l.kind==="Function"?(p.push({kind:"Pointer"}),p.push({kind:"FunctionPointer",params:l.params,variadic:l.variadic})):p.push(l);return p}return[...t,...i,...s]};function Je(t,s){for(let i=t.length-1;i>=0;i--)if(s(t[i]))return i;return-1}u.prototype.parseParamList=function(){const t=this.peekSpan();this.expectContext(e.LParen,"for parameter list");const s=[];let i=!1;if(this.peek()===e.RParen)return this.advance(),[s,i];if(this.peek()===e.Void){const n=this.pos;if(this.advance(),this.peek()===e.RParen)return this.advance(),[s,i];this.pos=n}if(this.peek()===e.Identifier){const n=this.peekValue();if((!this.typedefs.has(n)||this.shadowedTypedefs.has(n))&&!this.isTypeSpecifier())return this.parseKrIdentifierList()}for(;;){if(this.peek()===e.Ellipsis){this.advance(),i=!0;break}const n=this.getAttrFlag(x);this.skipGccExtensions();const a=this.getAttrFlag(y);this.setAttrFlag(y,!1),this.setAttrFlag(x,n);const r=this.parseTypeSpecifier();if(r!==null){const c=this.getAttrFlag(y),[o,h,p,l,g,S,m]=this.parseParamDeclaratorFull();this.skipGccExtensions();let d=r;for(let k=0;k<h;k++)d={type:"PointerType",base:d,addressSpace:"Default"};if(g.length>0){for(let k=g.length-1;k>=0;k--)d={type:"ArrayType",element:d,size:g[k]};d={type:"PointerType",base:d,addressSpace:"Default"}}const A=[];if(p.length>0){p[0]!==null&&A.push(p[0]);for(let k=p.length-1;k>=1;k--)d={type:"ArrayType",element:d,size:p[k]};d={type:"PointerType",base:d,addressSpace:"Default"}}l&&(d={type:"PointerType",base:d,addressSpace:"Default"}),this.setAttrFlag(y,a),this.setAttrFlag(x,n),s.push({typeSpec:d,name:o,fptrParams:S,isConst:c,vlaSizeExprs:A,fptrInnerPtrDepth:m})}else{this.setAttrFlag(y,a),this.setAttrFlag(x,n);break}if(!this.consumeIf(e.Comma))break}return this.expectClosing(e.RParen,t),[s,i]},u.prototype.parseKrIdentifierList=function(){const t=[];for(;this.peek()===e.Identifier;){const s=this.peekValue();if(this.advance(),t.push({typeSpec:{type:"IntType"},name:s,fptrParams:null,isConst:!1,vlaSizeExprs:[],fptrInnerPtrDepth:0}),!this.consumeIf(e.Comma))break}return this.expect(e.RParen),[t,!1]},u.prototype.parseParamDeclaratorFull=function(){let t=0;for(;this.consumeIf(e.Star);)t++,this.skipCvQualifiers(),this.skipGccExtensions();const c={pointerDepth:t,arrayDims:[],isFuncPtr:!1,ptrToArrayDims:[],fptrParams:null,fptrInnerPtrDepth:0};let o=null;for(this.peek()===e.LParen&&this.isParenDeclarator()?o=this.parseParenParamDeclarator(c):this.peek()===e.Identifier&&(o=this.peekValue(),this.advance());this.peek()===e.LBracket;)if(this.advance(),this.skipArrayQualifiers(),this.peek()===e.RBracket)c.arrayDims.push(null),this.advance();else if(this.peek()===e.Star&&this.pos+1<this.tokens.length&&this.tokens[this.pos+1].kind===e.RBracket)this.advance(),c.arrayDims.push(null),this.advance();else{const h=this.parseExpr();c.arrayDims.push(h),this.expect(e.RBracket)}if(this.peek()===e.LParen){c.isFuncPtr=!0;const[h]=this.parseParamList();c.fptrParams=h}return[o,c.pointerDepth,c.arrayDims,c.isFuncPtr,c.ptrToArrayDims,c.fptrParams,c.fptrInnerPtrDepth]},u.prototype.parseParenParamDeclarator=function(t){const s=this.pos;if(this.advance(),this.skipGccExtensions(),this.peek()===e.LBracket){for(;this.peek()===e.LBracket;)if(this.advance(),this.skipArrayQualifiers(),this.peek()===e.RBracket)t.arrayDims.push(null),this.advance();else{const i=this.parseExpr();t.arrayDims.push(i),this.expect(e.RBracket)}return this.expect(e.RParen),null}if(this.peek()===e.Star){let i=0;for(;this.consumeIf(e.Star);)i++,this.skipCvQualifiers(),this.skipGccExtensions();let n=null;this.peek()===e.Identifier?(n=this.peekValue(),this.advance()):this.peek()===e.LParen&&(n=this.extractParenName()),t.pointerDepth+=Math.max(0,i-1);const a=[];for(;this.peek()===e.LBracket;)if(this.advance(),this.skipArrayQualifiers(),this.peek()===e.RBracket)a.push(null),this.advance();else{const r=this.parseExpr();a.push(r),this.expect(e.RBracket)}if(this.expect(e.RParen),a.length>0&&this.peek()!==e.LParen)t.pointerDepth+=1,t.arrayDims.length=0,t.arrayDims.push(...a);else if(this.peek()===e.LParen){t.isFuncPtr=!0,t.fptrInnerPtrDepth=i;const[r]=this.parseParamList();t.fptrParams=r}else if(this.peek()===e.LBracket)for(;this.peek()===e.LBracket;)if(this.advance(),this.skipArrayQualifiers(),this.peek()===e.RBracket)t.ptrToArrayDims.push(null),this.advance();else{const r=this.parseExpr();t.ptrToArrayDims.push(r),this.expect(e.RBracket)}else t.pointerDepth+=1;return n}if(this.consumeIf(e.Caret)){let i=null;return this.peek()===e.Identifier&&(i=this.peekValue(),this.advance()),this.expect(e.RParen),this.peek()===e.LParen&&this.skipBalancedParens(),i}if(this.peek()===e.Identifier){const i=this.peekValue();if(this.advance(),this.peek()===e.LParen){t.isFuncPtr=!0;const[n]=this.parseParamList();t.fptrParams=n}if(this.expect(e.RParen),this.skipArrayDimensions(),!t.isFuncPtr&&this.peek()===e.LParen){t.isFuncPtr=!0;const[n]=this.parseParamList();t.fptrParams=n}return i}if(this.peek()===e.LParen){const i=this.pos,n=this.extractParenName();if(n!==null){if(this.skipArrayDimensions(),this.peek()===e.LParen){t.isFuncPtr=!0;const[a]=this.parseParamList();t.fptrParams=a}}else this.pos=i,this.skipBalancedParens();if(this.expect(e.RParen),this.skipArrayDimensions(),this.peek()===e.LParen){t.isFuncPtr=!0;const[a]=this.parseParamList();t.fptrParams=a}return n}return this.pos=s,null},u.prototype.extractParenName=function(){if(this.peek()!==e.LParen){if(this.peek()===e.Identifier){const s=this.peekValue();return this.advance(),s}return null}this.advance(),this.peek()===e.Star&&(this.advance(),this.skipCvQualifiers());let t;return this.peek()===e.LParen?t=this.extractParenName():this.peek()===e.Identifier?(t=this.peekValue(),this.advance()):t=null,this.consumeIf(e.RParen),t},u.prototype.tryParseParenAbstractDeclarator=function(){if(this.peek()!==e.LParen)return null;const t=this.pos;this.advance();let s=0;for(this.skipGccExtensions();this.consumeIf(e.Star);)s++,this.skipCvQualifiers(),this.skipGccExtensions();if(this.peek()===e.LParen){const n=this.tryParseParenAbstractDeclarator();if(n!==null)if(n.kind==="Simple"){const a=n.ptrDepth,r=n.arrayDims;if(this.peek()===e.LParen){const[h,p]=this.parseParamList();return this.consumeIf(e.RParen)?{kind:"NestedFnPtr",outerPtrDepth:s,innerPtrDepth:a,innerParams:h,innerVariadic:p}:(this.pos=t,null)}const c=s+a,o=[...r];for(;this.peek()===e.LBracket;){this.advance();let h=null;this.peek()!==e.RBracket&&(h=this.parseExpr()),this.expect(e.RBracket),o.push(h)}return this.consumeIf(e.RParen)?{kind:"Simple",ptrDepth:c,arrayDims:o}:(this.pos=t,null)}else return this.consumeIf(e.RParen)?n:(this.pos=t,null);else return this.pos=t,null}const i=[];for(;this.peek()===e.LBracket;){this.advance();let n=null;this.peek()!==e.RBracket&&(n=this.parseExpr()),this.expect(e.RBracket),i.push(n)}return this.consumeIf(e.RParen)?s>0||i.length>0?{kind:"Simple",ptrDepth:s,arrayDims:i}:(this.pos=t,null):(this.pos=t,null)};function Ze(t,s){const i=s?.gnuExtensions??!0,a=new bt(t,i).scan(),r=new u(a),c={start:{line:1,column:0},end:{line:1,column:0}},o=[];for(;!r.atEof();){const h=r.parseExternalDecl();h!==null?o.push(h):r.atEof()||r.advance()}return{type:"TranslationUnit",decls:o,start:0,end:t.length,loc:c}}self.onmessage=t=>{const{id:s,source:i,options:n}=t.data,a=performance.now();try{const r=Ze(i,n),c=performance.now()-a,o={type:"success",id:s,ast:r,elapsed:c};self.postMessage(o)}catch(r){const c=performance.now()-a,o=r instanceof Error?r.message:String(r),h={type:"error",id:s,error:{message:o},elapsed:c};self.postMessage(h)}}})();
